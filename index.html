import React, { useState, useEffect } from 'react';
import { MessageCircle, ShoppingCart, Ruler, MapPin, Send, User, ChevronDown } from 'lucide-react';

// --- الألوان المعتمدة لمحل اليرموك ---
const colors = {
  navy: '#001F3F',
  gold: '#D4AF37',
  marble: '#F5F5F5'
};

const App = () => {
  const [activeTab, setActiveTab] = useState('store');
  const [showChat, setShowChat] = useState(false);
  const [cartCount, setCartCount] = useState(0);

  return (
    <div className="min-h-screen bg-gray-50 font-sans text-right" dir="rtl">
      
      {/* --- الهيدر (Navigation) --- */}
      <nav className="bg-[#001F3F] text-white p-4 shadow-xl sticky top-0 z-50 border-b-2 border-[#D4AF37]">
        <div className="max-w-6xl mx-auto flex justify-between items-center">
          <div className="text-2xl font-bold tracking-widest text-[#D4AF37]">الـيـرمـوك للـخـيـاطـة</div>
          <div className="hidden md:flex gap-8">
            <button onClick={() => setActiveTab('store')} className="hover:text-[#D4AF37] transition">الأقمشة</button>
            <button onClick={() => setActiveTab('measure')} className="hover:text-[#D4AF37] transition">المقاسات</button>
            <button className="hover:text-[#D4AF37] transition">طلباتي</button>
          </div>
          <div className="flex items-center gap-4">
            <div className="relative">
              <ShoppingCart className="cursor-pointer hover:text-[#D4AF37]" />
              {cartCount > 0 && <span className="absolute -top-2 -right-2 bg-red-600 text-xs rounded-full px-1.5">{cartCount}</span>}
            </div>
            <User className="cursor-pointer border border-[#D4AF37] rounded-full p-1" />
          </div>
        </div>
      </nav>

      {/* --- المحتوى الرئيسي --- */}
      <main className="max-w-6xl mx-auto py-10 px-4">
        {activeTab === 'store' && <StoreSection addToCart={() => setCartCount(cartCount + 1)} />}
        {activeTab === 'measure' && <MeasurementSection />}
      </main>

      {/* --- المساعد الذكي (AI Chatbot) --- */}
      <div className="fixed bottom-6 left-6 z-50">
        {!showChat ? (
          <button 
            onClick={() => setShowChat(true)}
            className="bg-[#D4AF37] text-[#001F3F] p-4 rounded-full shadow-2xl hover:scale-110 transition flex items-center gap-2 font-bold"
          >
            <MessageCircle /> مساعد اليرموك
          </button>
        ) : (
          <ChatWindow close={() => setShowChat(false)} />
        )}
      </div>

      {/* --- الفوتر --- */}
      <footer className="bg-[#001F3F] text-white py-10 mt-20 border-t-4 border-[#D4AF37]">
        <div className="max-w-6xl mx-auto px-4 grid grid-cols-1 md:grid-cols-3 gap-10">
          <div>
            <h3 className="text-[#D4AF37] font-bold text-xl mb-4">عن اليرموك</h3>
            <p className="text-gray-300">متخصصون في أرقى الأقمشة الرجالية اليابانية والخياطة التقليدية بدقة متناهية منذ سنوات.</p>
          </div>
          <div>
            <h3 className="text-[#D4AF37] font-bold text-xl mb-4">روابط سريعة</h3>
            <ul className="space-y-2 text-gray-300">
              <li>• سياسة الخصوصية</li>
              <li>• شروط الاستخدام</li>
              <li>• تتبع الشحنة</li>
            </ul>
          </div>
          <div>
            <h3 className="text-[#D4AF37] font-bold text-xl mb-4">موقعنا</h3>
            <div className="flex items-center gap-2 text-gray-300">
              <MapPin size={18} /> اليمن - صنعاء - الأصبحي - الفرع الرئيسي
            </div>
          </div>
        </div>
      </footer>
    </div>
  );
};

// --- مكون المتجر (Store) ---
const StoreSection = ({ addToCart }) => {
  const products = [
    { id: 1, name: 'قطن ياباني فاخر', price: 350, img: 'https://images.unsplash.com/photo-1594938298603-c8148c4dae35?auto=format&fit=crop&q=80&w=400' },
    { id: 2, name: 'سلك سميراميس الأصلي', price: 420, img: 'https://images.unsplash.com/photo-1521572267360-ee0c2909d518?auto=format&fit=crop&q=80&w=400' },
    { id: 3, name: 'قماش شتوي صوف 100%', price: 550, img: 'https://images.unsplash.com/photo-1588444833098-42056294371a?auto=format&fit=crop&q=80&w=400' },
  ];

  return (
    <div>
      <h2 className="text-3xl font-bold text-[#001F3F] mb-8 border-r-4 border-[#D4AF37] pr-4">تشكيلة الأقمشة الفاخرة</h2>
      <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
        {products.map(p => (
          <div key={p.id} className="bg-white rounded-xl overflow-hidden shadow-lg border hover:border-[#D4AF37] transition">
            <img src={p.img} alt={p.name} className="w-full h-56 object-cover" />
            <div className="p-6">
              <h3 className="text-xl font-bold text-[#001F3F]">{p.name}</h3>
              <p className="text-gray-500 mb-4 font-semibold text-lg">{p.price} ر.س</p>
              <div className="space-y-2 mb-4">
                 <select className="w-full p-2 border rounded text-sm"><option>ياقة قلاب (سعودي)</option><option>ياقة سادة</option></select>
                 <select className="w-full p-2 border rounded text-sm"><option>كم كبك</option><option>كم سادة</option></select>
              </div>
              <button 
                onClick={addToCart}
                className="w-full bg-[#001F3F] text-white py-2 rounded-lg hover:bg-[#D4AF37] transition font-bold"
              >
                إضافة للتفصيل
              </button>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// --- مكون المقاسات (Measurements) ---
const MeasurementSection = () => {
  const [type, setType] = useState('standard');
  const sizes = { S: 52, M: 54, L: 56, XL: 58, XXL: 60 };

  return (
    <div className="bg-white p-8 rounded-2xl shadow-xl max-w-2xl mx-auto border-t-8 border-[#001F3F]">
      <h2 className="text-2xl font-bold text-[#001F3F] mb-6 flex items-center gap-2">
        <Ruler className="text-[#D4AF37]" /> تحديد المقاس (بالبوصة)
      </h2>
      <div className="flex bg-gray-100 p-1 rounded-xl mb-8">
        <button onClick={() => setType('standard')} className={`flex-1 py-2 rounded-lg transition ${type === 'standard' ? 'bg-white shadow text-[#D4AF37] font-bold' : ''}`}>مقاس جاهز</button>
        <button onClick={() => setType('custom')} className={`flex-1 py-2 rounded-lg transition ${type === 'custom' ? 'bg-white shadow text-[#D4AF37] font-bold' : ''}`}>مقاس مخصص</button>
      </div>

      {type === 'standard' ? (
        <div className="grid grid-cols-5 gap-3">
          {Object.entries(sizes).map(([label, length]) => (
            <button key={label} className="border-2 border-gray-200 py-4 rounded-xl hover:border-[#D4AF37] text-center group transition">
              <div className="font-bold text-xl group-hover:text-[#D4AF37]">{label}</div>
              <div className="text-xs text-gray-400 font-arabic">طول {length}</div>
            </button>
          ))}
        </div>
      ) : (
        <div className="grid grid-cols-2 gap-4 animate-fade-in">
          {['الطول', 'الكتف', 'الصدر', 'الكم', 'الرقبة'].map(label => (
            <div key={label}>
              <label className="block text-sm font-bold text-gray-700 mb-1">{label}</label>
              <input type="number" placeholder="0.0" className="w-full p-3 border rounded-xl focus:ring-2 focus:ring-[#D4AF37] outline-none" />
            </div>
          ))}
        </div>
      )}
      <button className="w-full mt-10 bg-[#D4AF37] text-[#001F3F] py-4 rounded-xl font-bold text-lg hover:shadow-lg transition">حفظ المقاسات في ملفي</button>
    </div>
  );
};

// --- نافذة المساعد الذكي (Chat Window) ---
const ChatWindow = ({ close }) => {
  const [msgs, setMsgs] = useState([{ text: "أهلاً بك في محل اليرموك، أنا مساعدك الذكي. هل تبحث عن قماش صيفي أم شتوي؟", isAi: true }]);
  const [input, setInput] = useState('');

  const send = () => {
    if(!input) return;
    setMsgs([...msgs, { text: input, isAi: false }, { text: "أبشر، جاري البحث في أرشيف الأقمشة لدينا...", isAi: true }]);
    setInput('');
  };

  return (
    <div className="bg-white w-80 h-96 rounded-2xl shadow-2xl flex flex-col border-2 border-[#D4AF37] overflow-hidden animate-slide-up">
      <div className="bg-[#001F3F] p-4 text-white flex justify-between items-center">
        <span className="font-bold">مساعد اليرموك الذكي</span>
        <button onClick={close} className="text-gray-400 hover:text-white">✕</button>
      </div>
      <div className="flex-1 p-4 overflow-y-auto space-y-3 bg-gray-50">
        {msgs.map((m, i) => (
          <div key={i} className={`p-2 rounded-lg max-w-[80%] text-sm ${m.isAi ? 'bg-white border-r-4 border-[#D4AF37] self-start' : 'bg-[#001F3F] text-white self-end mr-auto'}`}>
            {m.text}
          </div>
        ))}
      </div>
      <div className="p-3 border-t flex gap-2 bg-white">
        <input 
          value={input}
          onChange={(e) => setInput(e.target.value)}
          onKeyPress={(e) => e.key === 'Enter' && send()}
          placeholder="اسأل الخبير..." 
          className="flex-1 bg-gray-100 p-2 rounded-lg text-sm outline-none" 
        />
        <button onClick={send} className="bg-[#D4AF37] p-2 rounded-lg text-[#001F3F]"><Send size={18} /></button>
      </div>
    </div>
  );
};

export default App;
            
