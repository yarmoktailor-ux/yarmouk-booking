<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ« - Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --white: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); margin: 0; padding: 0; direction: rtl; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { text-align: center; padding: 30px; background: #fff; border-bottom: 3px solid var(--gold); }
        #main_logo { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; border: 2px solid var(--gold); }

        .container { max-width: 600px; margin: 20px auto; background: white; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; padding: 20px; padding-bottom: 80px; }
        
        /* Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .cust-data { background: #fff9eb; padding: 15px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #f0e6d2; }
        .cust-data input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }

        /* Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª */
        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .measure-grid input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; }
        .measure-grid label { font-size: 11px; display: block; text-align: center; color: var(--brown); font-weight: bold; }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© */
        .add-btn-large { width: 100%; padding: 20px; background: white; border: 2px dashed var(--gold); color: var(--gold); border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 16px; margin-bottom: 15px; }
        
        /* Ù„ÙˆØ­Ø© ÙŠØ§Ù‚ÙˆØª Ø§Ù„Ø°ÙƒÙŠ */
        .yaqoot-trigger { position: fixed; bottom: 20px; right: 20px; background: var(--brown); color: var(--gold); width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; z-index: 1000; border: 2px solid var(--gold); box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        .yaqoot-chat { display: none; position: fixed; bottom: 90px; right: 20px; width: 320px; height: 450px; background: white; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 1001; flex-direction: column; overflow: hidden; border: 2px solid var(--gold); }
        .chat-header { background: var(--brown); color: white; padding: 15px; text-align: center; font-weight: bold; display: flex; justify-content: space-between; }
        #chat_messages { flex: 1; padding: 15px; overflow-y: auto; background: #fdfbf7; display: flex; flex-direction: column; }
        .chat-input-area { display: flex; padding: 10px; border-top: 1px solid #eee; background: white; }
        .chat-input-area input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù…ÙˆØ¯Ø§Ù„ */
        #adminPanel { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:10000; overflow-y:auto; padding: 20px; box-sizing: border-box; }
        .product-modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:5000; overflow-y:auto; padding:20px; box-sizing:border-box; }
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .item-card { background: white; border-radius: 12px; overflow: hidden; text-align: center; padding-bottom: 10px; }
        .item-card img { width: 100%; height: 150px; object-fit: cover; }
        .price-old { text-decoration: line-through; color: red; font-size: 11px; }
        .price-new { color: green; font-weight: bold; font-size: 14px; }
        .tailor-opts { background: #f9f9f9; padding: 10px; border-radius: 10px; margin-top: 10px; font-size: 12px; }
        .tailor-opts select { width: 100%; padding: 5px; margin-bottom: 5px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="header">
    <img src="" id="main_logo" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø­Ù„">
    <h2 id="store_name">Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ« Ù„Ù„Ø®ÙŠØ§Ø·Ø©</h2>
</div>

<div class="container">
    <div class="cust-data">
        <h4 style="margin-top:0;">ğŸ‘¤ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆÙ…Ù‚Ø§Ø³Ø§ØªÙ‡:</h4>
        <input type="text" id="c_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (ÙˆØ§ØªØ³Ø§Ø¨)">
        <div class="measure-grid">
            <div><label>Ø·ÙˆÙ„</label><input type="number" class="m-val"></div>
            <div><label>ÙƒØªÙ</label><input type="number" class="m-val"></div>
            <div><label>ÙŠØ¯</label><input type="number" class="m-val"></div>
            <div><label>ØµØ¯Ø±</label><input type="number" class="m-val"></div>
            <div><label>Ø±Ù‚Ø¨Ø©</label><input type="number" class="m-val"></div>
            <div><label>ÙˆØ³Ø·</label><input type="number" class="m-val"></div>
            <div><label>ÙƒØ¨Ùƒ</label><input type="number" class="m-val"></div>
            <div><label>Ø®Ø·ÙˆØ©</label><input type="number" class="m-val"></div>
        </div>
    </div>

    <button class="add-btn-large" onclick="openProducts('fabric')">â• Ø¥Ø¶Ø§ÙØ© Ù‚Ù…Ø§Ø´ ØªÙØµÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
    <button class="add-btn-large" onclick="openProducts('ready')">â• Ø¥Ø¶Ø§ÙØ© Ø«ÙŠØ§Ø¨ Ø¬Ø§Ù‡Ø²Ø© / Ø´ÙŠÙ„Ø§Ù† / Ø£ÙƒÙˆØ§Øª</button>

    <div id="cart_area"></div>

    <div id="final_box" style="margin-top:20px; text-align:center; background:var(--brown); color:white; padding:20px; border-radius:15px;">
        <h3>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="total_price">0</span> Ø±ÙŠØ§Ù„</h3>
        <button onclick="submitOrder()" style="width:100%; padding:15px; background:var(--gold); color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">ØªØ£ÙƒÙŠØ¯ Ù‡ÙŠØ¨Ø© Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
    </div>
</div>

<div class="yaqoot-trigger" onclick="toggleYaqoot()">âœ¨</div>
<div id="yaqoot_chat" class="yaqoot-chat">
    <div class="chat-header">
        <span>ğŸ’ ÙŠØ§Ù‚ÙˆØª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</span>
        <span style="cursor:pointer" onclick="toggleYaqoot()">Ã—</span>
    </div>
    <div id="chat_messages"></div>
    <div class="chat-input-area">
        <input type="text" id="chat_input" placeholder="Ø§Ø³Ø£Ù„ ÙŠØ§Ù‚ÙˆØª Ø¹Ù† Ø§Ù„Ø£Ù‚Ù…Ø´Ø© Ø£Ùˆ Ø§Ù„ØªÙØµÙŠÙ„..." onkeypress="if(event.key==='Enter') askYaqoot()">
        <button onclick="askYaqoot()" style="background:none; border:none; font-size:20px; cursor:pointer;">ğŸš€</button>
    </div>
</div>

<div id="productModal" class="product-modal">
    <div style="display:flex; justify-content:space-between; color:white; margin-bottom:20px;">
        <h3 id="modal_title">Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</h3>
        <button onclick="closeProducts()" style="background:red; color:white; border:none; padding:10px; border-radius:5px;">Ø¥ØºÙ„Ø§Ù‚ X</button>
    </div>
    <div id="product_list" class="product-grid"></div>
</div>

<div id="adminPanel">
    <h2 style="text-align:center;">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø®Ø²Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</h2>
    <div class="admin-form">
        <h4>ğŸ–¼ï¸ ØªØºÙŠÙŠØ± Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø­Ù„:</h4>
        <input type="file" onchange="uploadLogo(this)">
    </div>
    <div id="admin_items_list"></div>
    <button onclick="closeAdmin()" style="width:100%; padding:15px; background:#666; color:white; border:none; border-radius:10px; margin-top:20px;">Ø®Ø±ÙˆØ¬</button>
</div>

<button onclick="checkAdmin()" style="position:fixed; bottom:10px; left:10px; background:none; border:none; font-size:20px; cursor:pointer; opacity:0.3;">âš™ï¸</button>

<script>
// --- ØªÙƒÙˆÙŠÙ† Firebase ---
const firebaseConfig = { databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com/" };
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const database = firebase.database();

let allProducts = [];
let cart = [];

// Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
database.ref('settings/logo').on('value', s => { document.getElementById('main_logo').src = s.val() || ''; });
database.ref('products').on('value', s => {
    allProducts = [];
    const data = s.val();
    if(data) for(let id in data) allProducts.push({...data[id], id});
    renderAdminList();
});

// --- Ø°ÙƒØ§Ø¡ ÙŠØ§Ù‚ÙˆØª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ù…Ø·ÙˆØ± 2026 ---
const yaqootKnowledge = {
    fabrics: {
        "Ù‚Ø·Ù†": "Ø§Ù„Ù‚Ø·Ù† Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ù‡Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø£Ù‚Ù…Ø´Ø© Ø§Ù„ØµÙŠÙÙŠØ©ØŒ Ø¨Ø§Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø³Ù…ØŒ ÙŠÙ…ØªØµ Ø§Ù„Ø±Ø·ÙˆØ¨Ø©ØŒ ÙˆÙŠÙ…ØªØ§Ø² Ø¨Ù…Ø³Ø§Ù…ÙŠØ© Ø¹Ø§Ù„ÙŠØ© ØªÙ…Ù†Ø­Ùƒ Ø´Ø¹ÙˆØ±Ø§Ù‹ Ø¨Ø§Ù„Ø§Ù†ØªØ¹Ø§Ø´ ÙÙŠ Ø£Ø´Ø¯ Ø§Ù„Ø£ÙŠØ§Ù… Ø­Ø±Ø§Ù‹.",
        "ØµÙˆÙ": "Ø§Ù„ØµÙˆÙ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ Ø£Ùˆ Ø§Ù„ÙƒØ´Ù…ÙŠØ±ÙŠ Ù‡Ùˆ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙØ®Ø§Ù…Ø© Ø§Ù„Ø´ØªÙˆÙŠØ©ØŒ ÙŠÙ…ØªØ§Ø² Ø¨Ø«Ù‚Ù„ Ù…ØªØ²Ù† ÙˆØ¯ÙØ¡ Ø·Ø¨ÙŠØ¹ÙŠØŒ ÙˆÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ø±ÙˆÙ†Ù‚Ù‡ ÙˆØ´ÙƒÙ„ Ø§Ù„Ø«ÙˆØ¨ Ù„ÙØªØ±Ø§Øª Ø·ÙˆÙŠÙ„Ø©.",
        "Ø³Ù„Ùƒ": "Ø£Ù‚Ù…Ø´Ø© Ø§Ù„Ø³Ù„Ùƒ (Ø§Ù„Ø¨ÙˆÙ„ÙŠØ³ØªØ± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬) ØªÙ…ØªØ§Ø² Ø¨Ø£Ù†Ù‡Ø§ Ù…Ù‚Ø§ÙˆÙ…Ø© Ù„Ù„ØªØ¬Ø¹Ø¯ØŒ Ø¹Ù…Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØŒ ÙˆØªÙ…Ù†Ø­ Ø§Ù„Ø«ÙˆØ¨ Ø§Ù†Ø³ÙŠØ§Ø¨ÙŠØ© ÙˆÙ†Ø¹ÙˆÙ…Ø© ÙØ§Ø¦Ù‚Ø©.",
        "ÙƒØªØ§Ù†": "Ø§Ù„ÙƒØªØ§Ù† ÙŠÙ…Ù†Ø­Ùƒ Ø¥Ø·Ù„Ø§Ù„Ø© 'ÙƒØ§Ø¬ÙˆØ§Ù„' ÙØ®Ù…Ø©ØŒ ÙŠÙ…ØªØ§Ø² Ø¨Ù…ØªØ§Ù†Ø© Ø§Ù„Ø®ÙŠÙˆØ· ÙˆØ¨Ø±ÙˆØ¯ØªÙ‡Ø§ØŒ ÙˆÙ‡Ùˆ Ø§Ù„Ù…ÙØ¶Ù„ Ù„Ù…Ù† ÙŠØ¨Ø­Ø« Ø¹Ù† Ø§Ù„ØªÙ…ÙŠØ² ÙˆØ§Ù„Ø§Ø®ØªÙ„Ø§Ù."
    },
    workflow: [
        "1ï¸âƒ£ **Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù‚Øµ:** Ù†Ø¨Ø¯Ø£ Ø¨Ù…Ù‚Øµ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø°Ù‡Ø¨ÙŠØŒ Ø­ÙŠØ« ÙŠØªÙ… Ù‚Øµ Ø§Ù„Ù‚Ù…Ø§Ø´ Ø¨Ø¯Ù‚Ø© Ø§Ù„Ù…Ù„ÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø¬Ø³Ø¯Ùƒ.",
        "2ï¸âƒ£ **Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø®ÙŠØ§Ø·Ø©:** ÙŠÙ†ØªÙ‚Ù„ Ø§Ù„Ù‚Ù…Ø§Ø´ Ù„ÙŠØ¯ Ø®ÙŠØ§Ø· Ù…Ø­ØªØ±ÙØŒ ÙŠÙØ®Ø§Ø· Ø¨Ø¢Ù„Ø§Øª Ø­Ø¯ÙŠØ«Ø© ÙˆØ®ÙŠÙˆØ· Ù…ØªÙŠÙ†Ø©.",
        "3ï¸âƒ£ **Ù…Ø±Ø­Ù„Ø© Ø§Ù„ÙƒØ§ÙˆÙŠØ©:** ÙŠÙÙƒÙˆÙ‰ Ø§Ù„Ø«ÙˆØ¨ Ø¨Ù…ÙƒØ§Ø¨Ø³ Ø¨Ø®Ø§Ø±ÙŠØ© Ø®Ø§ØµØ© ØªØ¸Ù‡Ø± ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚ØµØ©.",
        "4ï¸âƒ£ **Ù…Ø±Ø­Ù„Ø© Ø§Ù„ÙØ­Øµ ÙˆØ§Ù„ØªØºÙ„ÙŠÙ:** Ù„Ø§ ÙŠØ®Ø±Ø¬ Ø§Ù„Ø«ÙˆØ¨ Ø¥Ù„Ø§ Ø¨Ø¹Ø¯ Ù…Ø±ÙˆØ±Ù‡ Ø¹Ù„Ù‰ Ù‚Ø³Ù… Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¬ÙˆØ¯Ø©."
    ],
    suggestions: [
        "Ù†ØµÙŠØ­Ø© ÙŠØ§Ù‚ÙˆØª: Ù‡Ù„ ÙÙƒØ±Øª Ø¨Ø¥Ø¶Ø§ÙØ© 'Ø´Ø§Ù„ ÙƒØ´Ù…ÙŠØ±ÙŠ' Ù„Ù‡Ø°Ø§ Ø§Ù„Ø«ÙˆØ¨ØŸ Ø³ÙŠØ¹Ø²Ø² Ù…Ù† Ù‡ÙŠØ¨ØªÙƒ.",
        "Ø¨Ù…Ø§ Ø£Ù†Ùƒ Ø§Ø®ØªØ±Øª Ù‡Ø°Ø§ Ø§Ù„Ù‚Ù…Ø§Ø´ØŒ Ø£Ù‚ØªØ±Ø­ Ø¹Ù„ÙŠÙƒ Ø®ÙŠØ§Ø·Ø© 'Ø§Ù„Ù‚Ù„Ø§Ø¨ Ø§Ù„Ù…Ù„ÙƒÙŠ'.",
        "Ù„Ø§ ØªÙ†Ø³Ù ØªØµÙØ­ Ù‚Ø³Ù… Ø§Ù„Ø£ÙƒÙˆØ§Øª Ø§Ù„Ø´ØªÙˆÙŠØ©ØŒ Ù„Ø¯ÙŠÙ†Ø§ ØªØ´ÙƒÙŠÙ„Ø© ØªÙ„ÙŠÙ‚ Ø¨Ùƒ."
    ]
};

function toggleYaqoot() {
    const chat = document.getElementById('yaqoot_chat');
    chat.style.display = (chat.style.display === 'flex') ? 'none' : 'flex';
}

function askYaqoot() {
    const inp = document.getElementById('chat_input');
    const question = inp.value.trim();
    if(!question) return;
    
    addMessage(question, 'user');
    inp.value = "";

    setTimeout(() => {
        let reply = "";
        const q = question.toLowerCase();

        if(q.includes("Ù‚Ù…Ø§Ø´") || q.includes("Ù†ÙˆØ¹")) {
            reply = "Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ ØºØ§Ù„ÙŠ. Ù†Ø­Ù† ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù†Ù†ØªÙ‚ÙŠ Ø£Ù‚Ù…Ø´ØªÙ†Ø§ Ø¨Ø¹Ù†Ø§ÙŠØ©. ";
            if(q.includes("Ù‚Ø·Ù†")) reply += yaqootKnowledge.fabrics["Ù‚Ø·Ù†"];
            else if(q.includes("ØµÙˆÙ")) reply += yaqootKnowledge.fabrics["ØµÙˆÙ"];
            else reply += "Ù„Ø¯ÙŠÙ†Ø§ Ø£Ù‚Ù…Ø´Ø© Ù‚Ø·Ù†ÙŠØ© Ø¨Ø§Ø±Ø¯Ø©ØŒ ÙˆØ£ØµÙˆØ§Ù Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© ÙØ§Ø®Ø±Ø©. Ù…Ø§ Ù‡Ùˆ Ø´Ø¹ÙˆØ±Ùƒ Ø§Ù„Ù…ÙØ¶Ù„ØŸ";
        } 
        else if(q.includes("ÙƒÙŠÙ") && q.includes("Ø®ÙŠØ§Ø·")) {
            reply = "ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒØŒ Ø«ÙˆØ¨Ùƒ ÙŠÙ…Ø± Ø¨Ø±Ø­Ù„Ø© Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ø¶Ù…Ø§Ù† Ø§Ø·Ù„Ø§Ù„ØªÙƒ:%0A" + yaqootKnowledge.workflow.join("%0A");
        }
        else if(q.includes("Ù…Ù‚Ø§Ø³")) {
            reply = "ğŸ“ Ø¯Ù‚Ø© Ø§Ù„Ù…Ù‚Ø§Ø³ Ù‡ÙŠ ØªØ®ØµØµÙ†Ø§. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ²ÙˆÙŠØ¯Ù†Ø§ Ø¨Ù…Ù‚Ø§Ø³Ø§ØªÙƒ Ù‡Ù†Ø§ØŒ ÙˆØ³Ù†Ø­Ø±Øµ Ø£Ù† ÙŠØ¸Ù‡Ø± Ø§Ù„Ø«ÙˆØ¨ ÙƒØ£Ù†Ù‡ Ù…Ù†Ø­ÙˆØª Ø¹Ù„ÙŠÙƒ Ù†Ø­ØªØ§Ù‹.";
        }
        else if(q.includes("Ø´ÙƒØ±Ø§") || q.includes("ÙŠØ¹Ø·ÙŠÙƒ")) {
            reply = "Ø§Ù„Ø´ÙƒØ± Ù„Ùƒ Ù„Ø«Ù‚ØªÙƒ Ø¨Ù€ 'Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ'. Ù†Ø­Ù† Ù†ÙØ®Ø± Ø¨Ø®Ø¯Ù…Ø© Ø±Ø¬Ø§Ù„ Ø§Ù„ÙŠÙ…Ù† Ø§Ù„Ø£Ù†ÙŠÙ‚ÙŠÙ†.";
        }
        else {
            reply = "Ø³Ø¤Ø§Ù„Ùƒ Ù…Ø­Ù„ Ø§Ù‡ØªÙ…Ø§Ù…ÙŠ. " + yaqootKnowledge.suggestions[Math.floor(Math.random()*yaqootKnowledge.suggestions.length)];
        }
        addMessage(reply, 'yaqoot');
    }, 800);
}

function addMessage(text, sender) {
    const chatBody = document.getElementById('chat_messages');
    const div = document.createElement('div');
    div.style.marginBottom = "15px";
    div.style.padding = "12px";
    div.style.borderRadius = "15px";
    div.style.maxWidth = "85%";
    div.style.fontSize = "13px";
    div.style.lineHeight = "1.6";

    if(sender === 'user') {
        div.style.background = "#d4af37";
        div.style.color = "white";
        div.style.alignSelf = "flex-end";
        div.style.marginLeft = "auto";
    } else {
        div.style.background = "#f0f0f0";
        div.style.color = "#333";
        div.style.borderRight = "4px solid #5d4037";
    }

    div.innerHTML = text.replace(/%0A/g, '<br>');
    chatBody.appendChild(div);
    chatBody.scrollTop = chatBody.scrollHeight;
}

// ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
function openProducts(cat) {
    const list = document.getElementById('product_list');
    const filtered = allProducts.filter(p => p.cat === cat);
    list.innerHTML = filtered.map(p => `
        <div class="item-card">
            <img src="${p.img}">
            <div style="padding:10px;">
                <b>${p.name}</b>
                <div><span class="price-new">${p.newP} Ø±ÙŠØ§Ù„</span></div>
                <button onclick="addToCart('${p.id}')" style="width:100%; margin-top:8px; background:var(--gold); color:white; border:none; border-radius:5px; padding:8px; cursor:pointer;">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
            </div>
        </div>
    `).join('');
    document.getElementById('productModal').style.display = 'block';
}

function closeProducts() { document.getElementById('productModal').style.display = 'none'; }

function addToCart(id) {
    const p = allProducts.find(x => x.id === id);
    cart.push({...p, cartId: Date.now()});
    renderCart();
    closeProducts();
}

function renderCart() {
    const area = document.getElementById('cart_area');
    area.innerHTML = cart.map((p, idx) => `
        <div style="background:white; border:1px solid var(--gold); border-radius:15px; padding:15px; margin-bottom:10px; position:relative;">
            <button onclick="cart.splice(${idx},1); renderCart()" style="position:absolute; left:10px; top:10px; background:red; color:white; border:none; border-radius:50%; width:25px; height:25px;">Ã—</button>
            <b>${p.name}</b> - ${p.newP} Ø±ÙŠØ§Ù„
            ${p.cat === 'fabric' ? '<div class="tailor-opts"><select><option>Ø³Ø¹ÙˆØ¯ÙŠ</option><option>ÙƒÙˆÙŠØªÙŠ</option></select></div>' : ''}
        </div>
    `).join('');
    let total = cart.reduce((sum, item) => sum + parseInt(item.newP), 0);
    document.getElementById('total_price').innerText = total.toLocaleString();
}

function checkAdmin() { if(prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:") === "1234") document.getElementById('adminPanel').style.display='block'; }
function closeAdmin() { document.getElementById('adminPanel').style.display='none'; }
function submitOrder() {
    const name = document.getElementById('c_name').value;
    if(!name || cart.length === 0) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    window.open(`https://wa.me/9677XXXXXXXX?text=Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ${name}`);
}
</script>
</body>
</html>
