<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© - Ø§Ù„Ø¥Ø±Ø« ÙˆØ§Ù„Ø£Ù†Ø§Ù‚Ø©</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --dark: #1a1a1a; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); margin: 0; padding: 0; direction: rtl; color: var(--dark); }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: var(--brown); color: white; text-align: center; padding: 25px 10px; border-bottom: 4px solid var(--gold); }
        #main_logo { width: 90px; height: 90px; border-radius: 50%; border: 2px solid var(--gold); background: white; margin-bottom: 10px; cursor: pointer; }

        .container { max-width: 500px; margin: auto; padding: 15px; }

        /* Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ */
        .card { background: white; border-radius: 15px; padding: 15px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); border: 1px solid #eee; }
        .input-group input { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª */
        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin-top: 10px; }
        .measure-grid div { text-align: center; }
        .measure-grid input { width: 100%; padding: 6px; border: 1px solid #ddd; border-radius: 5px; text-align: center; font-size: 12px; }
        .measure-grid label { font-size: 10px; font-weight: bold; color: var(--brown); display: block; }

        /* Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ØµØºØ±Ø© */
        .pay-row { display: flex; gap: 10px; margin: 15px 0; }
        .bank-small { flex: 1; padding: 8px; border-radius: 10px; text-align: center; color: white; cursor: pointer; font-size: 11px; }
        .k-box { background: #0056b3; }
        .j-box { background: #f39c12; }
        .acc-link { display: block; text-decoration: underline; font-weight: bold; margin-top: 3px; font-size: 12px; }

        /* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .product-card { background: white; border-radius: 12px; overflow: hidden; border: 1px solid #eee; cursor: pointer; transition: 0.3s; margin-bottom: 10px; }
        .product-card img { width: 100%; height: 180px; object-fit: cover; border-bottom: 2px solid var(--gold); }
        .price-tag { color: #2e7d32; font-weight: bold; font-size: 15px; }
        .old-price { color: #999; text-decoration: line-through; font-size: 12px; margin-left: 5px; }

        /* Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØ¨ÙŠØ± */
        .action-btn { width: 100%; padding: 15px; background: white; border: 2px dashed var(--gold); color: var(--gold); border-radius: 12px; font-weight: bold; cursor: pointer; margin: 10px 0; }

        /* Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙˆØ§Ù„ØªØ£ÙƒÙŠØ¯ */
        .total-area { background: var(--brown); color: white; padding: 20px; border-radius: 15px; text-align: center; margin-top: 20px; }
        .confirm-btn { width: 100%; padding: 18px; background: #2e7d32; color: white; border: none; border-radius: 15px; font-size: 17px; font-weight: bold; margin-top: 15px; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }

        /* ÙŠØ§Ù‚ÙˆØª */
        .yaqoot-btn { position: fixed; bottom: 15px; right: 15px; background: var(--dark); color: var(--gold); border: 2px solid var(--gold); border-radius: 50px; padding: 10px 18px; cursor: pointer; z-index: 100; font-size: 13px; }

        /* Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        #adminPanel { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:2000; padding:20px; overflow-y:auto; box-sizing: border-box; }
        .admin-item { display:flex; justify-content:space-between; padding:10px; border-bottom:1px solid #eee; }
    </style>
</head>
<body>

<div class="header">
    <img src="" id="main_logo" onclick="location.reload()">
    <h2 style="margin:5px 0; font-size: 20px;">Ø§Ù„Ù€ÙŠÙ€Ø±Ù…Ù€ÙˆÙƒ Ø§Ù„Ù€Ø­Ù€Ø¯ÙŠØ«</h2>
    <div style="font-size: 11px; color: var(--gold);">Ù†ØµÙ†Ø¹ Ù‡ÙŠØ¨ØªÙƒ Ø¨Ø¯Ù‚Ø© Ø§Ù„Ù…Ù„ÙŠ</div>
</div>

<div class="container">
    <div class="card input-group">
        <label style="font-weight:bold; color:var(--brown); font-size:14px;">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„:</label>
        <input type="text" id="c_name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨">
        
        <div class="measure-grid">
            <div><label>Ø·ÙˆÙ„</label><input type="number" class="m-v"></div>
            <div><label>ÙƒØªÙ</label><input type="number" class="m-v"></div>
            <div><label>ÙŠØ¯</label><input type="number" class="m-v"></div>
            <div><label>ØµØ¯Ø±</label><input type="number" class="m-v"></div>
            <div><label>Ø±Ù‚Ø¨Ø©</label><input type="number" class="m-v"></div>
            <div><label>ÙˆØ³Ø·</label><input type="number" class="m-v"></div>
            <div><label>ÙƒØ¨Ùƒ</label><input type="number" class="m-v"></div>
            <div><label>Ø®Ø·ÙˆØ©</label><input type="number" class="m-v"></div>
        </div>
    </div>

    <button class="action-btn" onclick="openGallery('fabric')">â• ØªØµÙØ­ ÙˆØ§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ù‚Ù…Ø´Ø©</button>
    <button class="action-btn" onclick="openGallery('ready')">â• ØªØµÙØ­ Ø§Ù„Ø¬Ø§Ù‡Ø² ÙˆØ§Ù„Ø´ÙŠÙ„Ø§Ù†</button>

    <div id="cart_display"></div>

    <div class="pay-row">
        <div class="bank-small k-box" onclick="copy('3005374854')">
            ÙƒØ±ÙŠÙ…ÙŠ <span class="acc-link">3005374854</span>
        </div>
        <div class="bank-small j-box" onclick="copy('595720')">
            Ø¬ÙŠØ¨ <span class="acc-link">595720</span>
        </div>
    </div>

    <div class="total-area">
        <div style="font-size: 13px; opacity: 0.8;">Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</div>
        <h2 style="margin: 5px 0;"><span id="total_price">0</span> Ø±ÙŠØ§Ù„</h2>
    </div>

    <button class="confirm-btn" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ù‡ÙŠØ¨Ø© Ø§Ù„Ø·Ù„Ø¨ (ÙˆØ§ØªØ³Ø§Ø¨)</button>
</div>

<div id="galleryModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:1500; overflow-y:auto; padding:20px; box-sizing:border-box;">
    <div style="display:flex; justify-content:space-between; color:white; margin-bottom:15px;">
        <h3 id="gallery_title">Ø§Ù„Ù…Ø¹Ø±Ø¶</h3>
        <button onclick="closeGallery()" style="background:red; color:white; border:none; padding:8px 15px; border-radius:8px;">Ø¥ØºÙ„Ø§Ù‚ Ã—</button>
    </div>
    <div id="gallery_items"></div>
</div>

<div id="adminPanel">
    <h3 style="text-align:center; color:var(--brown);">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</h3>
    <div class="card">
        <h4>ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø¹Ø§Ø±:</h4>
        <input type="file" onchange="updateLogo(this)">
    </div>
    <div class="card">
        <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬/Ù‚Ù…Ø§Ø´:</h4>
        <select id="adm_cat"><option value="fabric">Ù‚Ù…Ø§Ø´</option><option value="ready">Ø¬Ø§Ù‡Ø²</option></select>
        <input type="text" id="adm_name" placeholder="Ø§Ù„Ø§Ø³Ù…" style="width:100%; margin:5px 0;">
        <input type="number" id="adm_old" placeholder="Ø§Ù„Ø³Ø¹Ø± Ù‚Ø¨Ù„" style="width:100%; margin:5px 0;">
        <input type="number" id="adm_new" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯" style="width:100%; margin:5px 0;">
        <textarea id="adm_desc" placeholder="ÙˆØµÙ Ø§Ù„Ù‚Ù…Ø§Ø´" style="width:100%; margin:5px 0;"></textarea>
        <input type="file" id="adm_file" onchange="encode(this)" style="margin:10px 0;">
        <button onclick="save()" style="width:100%; background:green; color:white; padding:10px; border:none;">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬</button>
    </div>
    <div id="admin_list"></div>
    <button onclick="document.getElementById('adminPanel').style.display='none'" style="width:100%; padding:10px;">Ø®Ø±ÙˆØ¬</button>
</div>

<div class="yaqoot-btn" onclick="alert('ğŸ’ ÙŠØ§Ù‚ÙˆØª: Ù†Ø­Ù† Ù†Ù‡ØªÙ… Ø¨Ø£Ø¯Ù‚ ØªÙØ§ØµÙŠÙ„Ùƒ Ù„Ø¶Ù…Ø§Ù† Ø¥Ø·Ù„Ø§Ù„Ø© ØªÙ„ÙŠÙ‚ Ø¨Ù…Ù‚Ø§Ù…Ùƒ.')">âœ¨ ÙŠØ§Ù‚ÙˆØª</div>
<button onclick="checkAdm()" style="position:fixed; bottom:5px; left:5px; opacity:0.1; background:none; border:none;">âš™ï¸</button>

<script>
const firebaseConfig = { databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com/" };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let items = [];
let cart = [];
let tempImg = "";

// Ø§Ù„Ù…Ø²Ø§Ù…Ù†Ø©
db.ref('settings/logo').on('value', s => document.getElementById('main_logo').src = s.val());
db.ref('products').on('value', s => {
    items = [];
    const data = s.val();
    if(data) for(let id in data) items.push({...data[id], id});
    renderAdmin();
});

function copy(t) { navigator.clipboard.writeText(t); alert("ØªÙ… Ù†Ø³Ø®: " + t); }

function openGallery(cat) {
    const box = document.getElementById('gallery_items');
    const filtered = items.filter(i => i.cat === cat);
    box.innerHTML = filtered.map(i => `
        <div class="product-card" onclick="addToCart('${i.id}')">
            <img src="${i.img}">
            <div style="padding:10px; text-align:center;">
                <b style="display:block;">${i.name}</b>
                <small style="color:#666;">${i.desc || ''}</small>
                <div style="margin-top:5px;">
                    <span class="old-price">${i.old || ''}</span>
                    <span class="price-tag">${i.new} Ø±ÙŠØ§Ù„</span>
                </div>
                <button style="margin-top:10px; background:var(--gold); color:white; border:none; padding:5px 15px; border-radius:5px;">Ø§Ø®ØªÙŠØ§Ø± Ù‡Ø°Ø§</button>
            </div>
        </div>
    `).join('');
    document.getElementById('galleryModal').style.display = 'block';
}

function closeGallery() { document.getElementById('galleryModal').style.display = 'none'; }

function addToCart(id) {
    const item = items.find(x => x.id === id);
    cart.push(item);
    renderCart();
    closeGallery();
}

function renderCart() {
    const display = document.getElementById('cart_display');
    display.innerHTML = cart.map((c, idx) => `
        <div style="background:#fff; border:1px solid #ddd; padding:10px; border-radius:10px; margin-top:5px; display:flex; align-items:center;">
            <img src="${c.img}" style="width:50px; height:50px; border-radius:5px; margin-left:10px;">
            <div style="flex:1;"><b>${c.name}</b><br><small>${c.new} Ø±ÙŠØ§Ù„</small></div>
            <button onclick="cart.splice(${idx},1); renderCart();" style="background:red; color:white; border:none; border-radius:50%; width:25px; height:25px;">Ã—</button>
        </div>
    `).join('');
    let total = cart.reduce((s, i) => s + parseInt(i.new), 0);
    document.getElementById('total_price').innerText = total.toLocaleString();
}

function sendOrder() {
    const name = document.getElementById('c_name').value;
    if(!name || cart.length === 0) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    alert(`âœ¨ ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ ÙŠØ§ ${name} âœ¨\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒØŒ Ø³Ù†Ù†ØªÙ‚Ù„ Ø§Ù„Ø¢Ù† Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨.`);
    window.open(`https://wa.me/9677XXXXXXXX?text=Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¹Ù…ÙŠÙ„: ${name}`);
}

// Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
function checkAdm() { if(prompt("Pass:") === "1234") document.getElementById('adminPanel').style.display='block'; }
function updateLogo(input) {
    const r = new FileReader();
    r.onload = e => db.ref('settings/logo').set(e.target.result);
    r.readAsDataURL(input.files[0]);
}
function encode(input) {
    const r = new FileReader();
    r.onload = e => tempImg = e.target.result;
    r.readAsDataURL(input.files[0]);
}
function save() {
    const n = document.getElementById('adm_name').value;
    const o = document.getElementById('adm_old').value;
    const nw = document.getElementById('adm_new').value;
    const c = document.getElementById('adm_cat').value;
    const d = document.getElementById('adm_desc').value;
    db.ref('products').push({name:n, old:o, new:nw, cat:c, desc:d, img:tempImg}).then(() => alert("ØªÙ… Ø§Ù„Ø­ÙØ¸!"));
}
function renderAdmin() {
    document.getElementById('admin_list').innerHTML = items.map(i => `
        <div class="admin-item">
            <span>${i.name}</span>
            <button onclick="db.ref('products/${i.id}').remove()" style="background:red; color:white;">Ø­Ø°Ù</button>
        </div>
    `).join('');
}
</script>
</body>
</html>
