<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© - Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ 2026</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --white: #ffffff; --dark: #1a1a1a; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 10px; direction: rtl; }
        
        .main-container { max-width: 600px; margin: auto; background: var(--white); border-radius: 20px; border: 1px solid var(--gold); box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        
        .welcome-banner { background: var(--brown); color: white; padding: 15px; text-align: center; font-size: 13px; border-bottom: 2px solid var(--gold); }
        .heritage-box { padding: 15px; background: #fffdf5; border-bottom: 1px solid #eee; text-align: center; font-size: 14px; color: #555; line-height: 1.6; }

        .header { text-align: center; padding: 20px; border-bottom: 2px solid var(--gold); background: white; }
        .logo { width: 140px; margin-bottom: 10px; border-radius: 10px; }
        
        .cust-info { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; background: #fff9eb; }
        .cust-info input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; width: 100%; box-sizing: border-box; }

        .main-tabs { display: flex; background: #eee; }
        .tab-btn { flex: 1; padding: 15px; border: none; cursor: pointer; font-weight: bold; background: #eee; color: #666; font-size: 14px; }
        .tab-btn.active { background: var(--gold); color: white; }

        .section { display: none; padding: 15px; }
        .section.active { display: block; }

        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 15px 0; background: #f9f9f9; padding: 10px; border-radius: 10px; border: 1px solid #eee; }
        .measure-grid label { font-size: 11px; color: var(--brown); font-weight: bold; display: block; margin-bottom: 4px; }
        .measure-grid input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; box-sizing: border-box; font-size: 13px; }

        .ready-nav { display: flex; gap: 5px; margin-bottom: 15px; overflow-x: auto; padding-bottom: 5px; }
        .ready-type-btn { padding: 8px 18px; border: 1px solid var(--gold); border-radius: 50px; background: white; white-space: nowrap; cursor: pointer; font-size: 12px; }
        .ready-type-btn.active { background: var(--brown); color: white; }
        
        .items-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .product-card { border: 1px solid #eee; border-radius: 15px; overflow: hidden; background: white; text-align: center; padding-bottom: 10px; transition: 0.3s; }
        .product-card img { width: 100%; height: 160px; object-fit: cover; }

        .yaqoot-btn { position: fixed; bottom: 85px; left: 20px; background: var(--dark); color: var(--gold); border: 2px solid var(--gold); border-radius: 50px; padding: 12px 25px; cursor: pointer; z-index: 1000; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .yaqoot-chat { display: none; position: fixed; bottom: 145px; left: 20px; width: 280px; background: white; border: 2px solid var(--gold); border-radius: 20px; z-index: 1001; box-shadow: 0 10px 40px rgba(0,0,0,0.3); overflow: hidden; }

        .btn-send { width: 100%; padding: 18px; background: var(--brown); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 20px; cursor: pointer; }
        .settings-btn { position: fixed; bottom: 20px; left: 20px; background: var(--white); border: 1px solid var(--gold); border-radius: 50%; width: 55px; height: 55px; cursor: pointer; font-size: 26px; z-index: 1000; display: flex; align-items: center; justify-content: center; }
        
        .selected-thobe-card { background: #fff9eb; border: 1px solid var(--gold); border-radius: 15px; padding: 15px; margin-bottom: 15px; position: relative; }
        .remove-card { position: absolute; top: -10px; left: -10px; background: #ff4d4d; color: white; border: none; border-radius: 50%; width: 28px; height: 28px; cursor: pointer; }
        .thobe-opt { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd; font-size: 12px; margin-top: 5px; }
        
        .help-icon { background:var(--gold); color:white; border-radius:50%; width:18px; height:18px; display:inline-flex; align-items:center; justify-content:center; font-size:11px; cursor:pointer; margin-right:8px; vertical-align: middle; }
        
        /* Modal Style */
        .modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:10000; justify-content:center; align-items:center; padding:20px; }
        .modal-content { background:white; width:100%; max-width:450px; border-radius:20px; overflow:hidden; position:relative; }
    </style>
</head>
<body>

<div class="welcome-banner">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. "Ø¥Ø±Ø« Ø§Ù„ÙˆØ§Ù„Ø¯ ÙŠØ±Ø­Ø¨ Ø¨Ùƒ" âœ¨</div>

<div class="heritage-box">
    <strong>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. Ø®ÙŠØ·ÙŒ Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠØŒ ÙˆÙ†Ø³ÙŠØ¬ÙŒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</strong><br>
    Ù…Ù†Ø° 2002ØŒ Ù†ØµÙ†Ø¹ Ø­Ø¶ÙˆØ±Ùƒ Ø¨Ø¯Ù‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ ÙˆØ®Ø¨Ø±Ø© Ø§Ù„Ø³Ù†ÙŠÙ†.
</div>

<button class="settings-btn" onclick="openAdmin()">âš™ï¸</button>

<div class="yaqoot-btn" onclick="toggleYaqoot()">âœ¨ ÙŠØ§Ù‚ÙˆØª</div>
<div id="yaqoot_chat" class="yaqoot-chat">
    <div style="background:var(--brown); color:white; padding:12px; font-weight:bold; display:flex; justify-content:space-between;">
        <span>ÙŠØ§Ù‚ÙˆØª - Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ù†Ø§Ù‚Ø©</span>
        <span onclick="toggleYaqoot()" style="cursor:pointer">Ã—</span>
    </div>
    <div style="padding:15px; font-size:13px;" id="chat_text">
        Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
        <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
        <button onclick="yaqootReply('policy')" style="width:100%; margin-bottom:8px; padding:8px; border:1px solid var(--gold); background:white; border-radius:8px; cursor:pointer;">ğŸ›¡ï¸ Ø§Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø°Ù‡Ø¨ÙŠ</button>
        <button onclick="yaqootReply('about')" style="width:100%; padding:8px; border:1px solid var(--gold); background:white; border-radius:8px; cursor:pointer;">ğŸ“œ Ù‚ØµØ© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</button>
    </div>
</div>

<div class="main-container">
    <div class="header">
        <img src="https://i.ibb.co/C3YFp0k7/688339f4-1296-48c0-bc66-3be039832675.png" class="logo" id="store_logo">
        <h2 style="margin:0; color:var(--brown);">Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ«</h2>
    </div>

    <div class="cust-info">
        <input type="text" id="c_name" placeholder="Ø¥Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    </div>

    <div class="main-tabs">
        <button class="tab-btn active" onclick="switchMainTab('tailor', this)">Ø§Ù„ØªÙØµÙŠÙ„</button>
        <button class="tab-btn" onclick="switchMainTab('ready', this)">Ø§Ù„Ø¬Ø§Ù‡Ø²</button>
    </div>

    <div id="section_tailor" class="section active">
        <h4 style="color:var(--brown); margin-bottom:10px;">ğŸ“ Ù…Ù‚Ø§Ø³Ø§ØªÙƒ (Ù‡Ù†Ø´) <span class="help-icon" onclick="openGuide()">ØŸ</span></h4>
        <div class="measure-grid">
            <div><label>Ø·ÙˆÙ„</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>ÙƒØªÙ</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>ÙŠØ¯</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>ØµØ¯Ø±</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø±Ù‚Ø¨Ø©</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>ÙˆØ³Ø· ÙŠØ¯</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>ÙƒØ¨Ùƒ</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø®Ø·ÙˆØ©</label><input type="number" step="0.1" class="m-input"></div>
        </div>
        <button onclick="openFabricModal()" style="width:100%; padding:15px; background:white; border:2px dashed var(--gold); border-radius:15px; color:var(--gold); font-weight:bold; cursor:pointer;">+ Ø§Ø®ØªØ± Ø§Ù„Ù‚Ù…Ø§Ø´ ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„ØªÙØµÙŠÙ„</button>
        <div id="tailor_list" style="margin-top:15px;"></div>
    </div>

    <div id="section_ready" class="section">
        <div class="ready-nav">
            <button class="ready-type-btn active" onclick="filterReady('all', this)">Ø§Ù„ÙƒÙ„</button>
            <button class="ready-type-btn" onclick="filterReady('thobe_r', this)">Ø«ÙŠØ§Ø¨</button>
            <button class="ready-type-btn" onclick="filterReady('coat_r', this)">Ø£ÙƒÙˆØ§Øª</button>
            <button class="ready-type-btn" onclick="filterReady('shawl_r', this)">Ø´ÙŠÙ„Ø§Ù†</button>
        </div>
        <div id="ready_display" class="items-grid"></div>
    </div>

    <div style="padding:15px; border-top:5px solid #eee;">
        <h4 style="font-size:14px; margin-bottom:10px;">ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</h4>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <button onclick="selectPayment('Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ', 'Ø­Ø³Ø§Ø¨: 3005374854')" style="padding:10px; border-radius:10px; border:1px solid #ddd; background:white; cursor:pointer;">Ø¨Ù†Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ</button>
            <button onclick="selectPayment('Ø¬ÙŠØ¨', 'Ù†Ù‚Ø·Ø©: 595720')" style="padding:10px; border-radius:10px; border:1px solid #ddd; background:white; cursor:pointer;">Ù…Ø­ÙØ¸Ø© Ø¬ÙŠØ¨</button>
        </div>
        <div id="pay_info" style="display:none; margin-top:10px; background:#fff9eb; padding:10px; border-radius:10px; text-align:center; font-weight:bold; color:var(--brown);"></div>
    </div>

    <div style="background:var(--brown); color:white; padding:20px; text-align:center;">
        <h3 style="margin:0;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="final_total">0</span> Ø±ÙŠØ§Ù„</h3>
        <button class="btn-send" onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ Ø§Ù„Ù‡ÙŠØ¨Ø© Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨</button>
        <input type="hidden" id="selected_payment" value="Ù„Ù… ÙŠØ­Ø¯Ø¯">
    </div>
</div>

<div id="fabricModal" class="modal-overlay">
    <div class="modal-content" style="padding:20px; max-height:80vh; overflow-y:auto;">
        <h3 style="text-align:center;">Ø£Ù‚Ù…Ø´Ø© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„ÙØ§Ø®Ø±Ø©</h3>
        <div id="modal_fabric_list" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"></div>
        <button onclick="closeModal('fabricModal')" style="width:100%; margin-top:15px; padding:10px; border:none; border-radius:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<div id="guideModal" class="modal-overlay">
    <div class="modal-content" style="padding:20px;">
        <h3 style="color:var(--brown); text-align:center;">ğŸ“ ÙƒÙŠÙ ØªØ£Ø®Ø° Ù…Ù‚Ø§Ø³ÙƒØŸ</h3>
        <p style="font-size:14px; line-height:1.6;">Ù„Ø¶Ù…Ø§Ù† Ø¯Ù‚Ø© "Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ"ØŒ ÙŠÙÙØ¶Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØªØ± Ù…Ø±Ù†:</p>
        <ul style="font-size:13px;">
            <li><b>Ø§Ù„Ø·ÙˆÙ„:</b> Ù…Ù† Ø§Ù„ÙƒØªÙ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ¹Ø¨.</li>
            <li><b>Ø§Ù„ØµØ¯Ø±:</b> Ø§Ù„Ù‚ÙŠØ§Ø³ Ø¯Ø§Ø¦Ø±ÙŠ Ù…Ø¹ ØªØ±Ùƒ Ø¥ØµØ¨Ø¹ÙŠÙ† Ù„Ù„Ø±Ø§Ø­Ø©.</li>
            <li><b>Ø§Ù„ÙŠØ¯:</b> Ù…Ù† Ø¹Ø¸Ù…Ø© Ø§Ù„ÙƒØªÙ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¹ØµÙ….</li>
        </ul>
        <button onclick="closeGuide()" style="width:100%; padding:12px; background:var(--gold); color:white; border:none; border-radius:10px; cursor:pointer; font-weight:bold;">ÙÙ‡Ù…ØªØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¢Ù†</button>
    </div>
</div>

<div id="adminPanel" class="modal-overlay">
    <div class="modal-content" style="padding:20px; background:#222; color:white;">
        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h3>
        <select id="adm_cat" style="width:100%; padding:10px; margin-bottom:10px;">
            <option value="fabric">Ù‚Ù…Ø§Ø´ ØªÙØµÙŠÙ„</option>
            <option value="thobe_r">Ø«ÙˆØ¨ Ø¬Ø§Ù‡Ø²</option>
            <option value="coat_r">ÙƒÙˆØª Ø¬Ø§Ù‡Ø²</option>
            <option value="shawl_r">Ø´Ø§Ù„ Ø¬Ø§Ù‡Ø²</option>
        </select>
        <input type="file" id="adm_file" onchange="encodeImg(this)" style="margin-bottom:10px;">
        <input type="text" id="adm_title" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" style="width:100%; padding:10px; margin-bottom:10px;">
        <input type="number" id="adm_price" placeholder="Ø§Ù„Ø³Ø¹Ø±" style="width:100%; padding:10px; margin-bottom:10px;">
        <button onclick="saveToCloud()" style="width:100%; padding:15px; background:var(--gold); color:white; border:none; border-radius:10px;">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
        <button onclick="closeModal('adminPanel')" style="width:100%; margin-top:10px; background:none; color:white; border:none;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<script>
// 1. Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
const firebaseConfig = { databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com/" };
if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const database = firebase.database();

let db = { fabrics: [], ready: [] };
let tempImg = "";
let readyTotal = 0;

// 2. Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
database.ref('products').on('value', (snapshot) => {
    const data = snapshot.val();
    db.fabrics = []; db.ready = [];
    if (data) {
        for (let id in data) {
            let item = data[id]; item.s_id = id;
            if (item.cat === 'fabric') db.fabrics.push(item);
            else db.ready.push(item);
        }
    }
    filterReady('all');
});

// 3. Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
function switchMainTab(sect, btn) {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    btn.classList.add('active');
    document.getElementById('section_' + sect).classList.add('active');
}

// 4. Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª ÙˆØ­ÙØ¸Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
function closeGuide() {
    document.getElementById('guideModal').style.display = 'none';
    localStorage.setItem('yarmok_guide_seen', 'true');
}

function openGuide() { document.getElementById('guideModal').style.display = 'flex'; }

window.onload = () => {
    // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª
    const saved = JSON.parse(localStorage.getItem('yarmok_measures'));
    if (saved) {
        document.querySelectorAll('.m-input').forEach((inp, i) => inp.value = saved[i]);
    }
    // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¯Ù„ÙŠÙ„ Ù„Ù„Ø¬Ø¯ÙŠØ¯
    if (!localStorage.getItem('yarmok_guide_seen')) {
        setTimeout(openGuide, 2000);
    }
};

document.querySelectorAll('.m-input').forEach(inp => {
    inp.oninput = () => {
        const vals = Array.from(document.querySelectorAll('.m-input')).map(i => i.value);
        localStorage.setItem('yarmok_measures', JSON.stringify(vals));
    };
});

// 5. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ¬Ø±
function openFabricModal() {
    const list = document.getElementById('modal_fabric_list');
    list.innerHTML = db.fabrics.map(f => `
        <div onclick="addThobe('${f.title}', ${f.newPrice}, '${f.img}')" style="border:1px solid #eee; border-radius:10px; padding:10px; text-align:center; cursor:pointer;">
            <img src="${f.img}" style="width:100%; height:60px; object-fit:cover; border-radius:5px;">
            <div style="font-size:12px; font-weight:bold; margin-top:5px;">${f.title}</div>
            <div style="font-size:11px; color:green;">${f.newPrice} Ø±ÙŠØ§Ù„</div>
        </div>
    `).join('');
    document.getElementById('fabricModal').style.display = 'flex';
}

function addThobe(name, price, img) {
    const id = Date.now();
    const div = document.createElement('div');
    div.className = 'selected-thobe-card';
    div.id = `thobe_${id}`;
    div.innerHTML = `
        <button class="remove-card" onclick="removeThobe(${id}, ${price})">Ã—</button>
        <div style="display:flex; gap:10px; align-items:center;">
            <img src="${img}" style="width:40px; height:40px; border-radius:5px; object-fit:cover;">
            <div style="font-size:13px;"><b>Ø«ÙˆØ¨: ${name}</b><br>${price} Ø±ÙŠØ§Ù„</div>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:5px; margin-top:10px;">
            <select class="thobe-opt"><option>Ù‚Ù„Ø§Ø¨ Ù…Ù„ÙƒÙŠ</option><option>ØµÙŠÙ†ÙŠ</option></select>
            <select class="thobe-opt"><option>ÙƒØ¨Ùƒ Ù‚Ù…Ø§Ø´</option><option>Ø³Ø§Ø¯Ø©</option></select>
            <select class="thobe-opt"><option>Ø²Ø±Ø§Ø± Ù…Ø®ÙÙŠ</option><option>Ø³Ø­Ø§Ø¨</option></select>
            <select class="thobe-opt"><option>Ù‚ØµØ© Ø³Ø¹ÙˆØ¯ÙŠØ©</option><option>Ù‚ØµØ© Ù‚Ø·Ø±ÙŠØ©</option></select>
        </div>
        <input type="hidden" class="t-price" value="${price}">
    `;
    document.getElementById('tailor_list').appendChild(div);
    calcTotal();
    closeModal('fabricModal');
}

function removeThobe(id, price) {
    document.getElementById(`thobe_${id}`).remove();
    calcTotal();
}

function filterReady(cat, btn) {
    if(btn) {
        document.querySelectorAll('.ready-type-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }
    const display = document.getElementById('ready_display');
    const items = cat === 'all' ? db.ready : db.ready.filter(i => i.cat === cat);
    display.innerHTML = items.map(i => `
        <div class="product-card">
            <img src="${i.img}">
            <div style="padding:10px; font-size:13px;">
                <b>${i.title}</b><br><span style="color:green;">${i.newPrice} Ø±ÙŠØ§Ù„</span><br>
                <button onclick="addReady(${i.newPrice})" style="width:100%; margin-top:5px; background:var(--gold); color:white; border:none; border-radius:5px; padding:5px; cursor:pointer;">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø·Ù„Ø¨</button>
            </div>
        </div>
    `).join('');
}

function addReady(p) { readyTotal += p; calcTotal(); alert("ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©"); }

function calcTotal() {
    let t = readyTotal;
    document.querySelectorAll('.t-price').forEach(p => t += parseInt(p.value));
    document.getElementById('final_total').innerText = t.toLocaleString();
}

function selectPayment(name, info) {
    document.getElementById('selected_payment').value = name;
    document.getElementById('pay_info').style.display = 'block';
    document.getElementById('pay_info').innerText = info;
}

// 6. Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (ÙˆØ§ØªØ³Ø§Ø¨)
function submitOrder() {
    const name = document.getElementById('c_name').value;
    const phone = document.getElementById('c_phone').value;
    const total = document.getElementById('final_total').innerText;
    if(!name || total === "0") return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹");

    let mText = "ğŸ“ *Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª:*%0A";
    const labels = ["Ø·ÙˆÙ„", "ÙƒØªÙ", "ÙŠØ¯", "ØµØ¯Ø±", "Ø±Ù‚Ø¨Ø©", "ÙˆØ³Ø·", "ÙƒØ¨Ùƒ", "Ø®Ø·ÙˆØ©"];
    document.querySelectorAll('.m-input').forEach((inp, i) => mText += `${labels[i]}: ${inp.value || '--'} | `);

    let tText = "%0Aâœ‚ï¸ *Ø§Ù„ØªÙØµÙŠÙ„:*%0A";
    document.querySelectorAll('.selected-thobe-card').forEach(t => {
        const title = t.querySelector('b').innerText;
        const opts = t.querySelectorAll('.thobe-opt');
        tText += `- ${title} (${opts[0].value}, ${opts[1].value}, ${opts[3].value})%0A`;
    });

    const msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ*%0AğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${name}%0AğŸ“ Ø§Ù„Ù‡Ø§ØªÙ: ${phone}%0A${mText}%0A${tText}%0AğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${total} Ø±ÙŠØ§Ù„`;
    window.open(`https://wa.me/9677XXXXXXXX?text=${msg}`); // Ø§Ø³ØªØ¨Ø¯Ù„ X Ø¨Ø±Ù‚Ù…Ùƒ
}

// 7. ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
function openAdmin() { if(prompt("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±:") === "1234") document.getElementById('adminPanel').style.display = 'flex'; }
function closeModal(id) { document.getElementById(id).style.display = 'none'; }
function encodeImg(input) {
    const reader = new FileReader();
    reader.onload = (e) => tempImg = e.target.result;
    reader.readAsDataURL(input.files[0]);
}
function saveToCloud() {
    const cat = document.getElementById('adm_cat').value;
    const title = document.getElementById('adm_title').value;
    const price = document.getElementById('adm_price').value;
    if(!tempImg || !title) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    database.ref('products').push({ cat, title, newPrice: price, img: tempImg })
    .then(() => { alert("ØªÙ… Ø§Ù„Ù†Ø´Ø±"); closeModal('adminPanel'); });
}

function toggleYaqoot() {
    const chat = document.getElementById('yaqoot_chat');
    chat.style.display = chat.style.display === 'block' ? 'none' : 'block';
}
function yaqootReply(t) {
    const text = t === 'policy' ? "ğŸ›¡ï¸ Ø¶Ù…Ø§Ù†Ù†Ø§: Ø¯Ù‚Ø© Ø¨Ø§Ù„Ù…Ù„ÙŠ Ø£Ùˆ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¬Ø§Ù†Ø§Ù‹ Ù…Ø¹ Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ." : "ğŸ“œ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ: Ø®Ø¨Ø±Ø© Ø¨Ø¯Ø£Øª Ù…Ù†Ø° Ø¹Ø§Ù… 2002 Ù„Ù†ØµÙ†Ø¹ Ù„Ùƒ Ù‡ÙŠØ¨Ø© ØªÙ„ÙŠÙ‚ Ø¨Ùƒ.";
    document.getElementById('chat_text').innerHTML = text;
}
</script>
</body>
</html>
