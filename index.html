<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ù†ØµØ© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„Ø©</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --gold: #d4af37; --navy: #001f3f; --bg: #fdfbf7; --white: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; direction: rtl; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± ÙˆØ§Ù„Ø´Ø¹Ø§Ø± */
        .header { background: white; padding: 20px; text-align: center; border-bottom: 3px solid var(--gold); position: relative; }
        .logo-container img { max-width: 150px; height: auto; border-radius: 10px; }
        
        .container { max-width: 1000px; margin: auto; padding: 20px; }
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; }
        .tab-btn { flex: 1; padding: 15px; border: none; background: #eee; cursor: pointer; border-radius: 10px; font-weight: bold; min-width: 120px; }
        .tab-btn.active { background: var(--gold); color: white; }

        .section { display: none; background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .section.active { display: block; }

        /* Ø§Ù„Ù…ØªØ¬Ø± */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .card { border: 1px solid #eee; border-radius: 15px; overflow: hidden; background: white; text-align: center; padding-bottom: 15px; transition: 0.3s; }
        .card img { width: 100%; height: 200px; object-fit: cover; }
        .price { color: var(--gold); font-weight: bold; font-size: 1.2em; }

        /* Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª */
        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; }
        .measure-input { text-align: center; padding: 10px; border: 1px solid #ddd; border-radius: 8px; width: 100%; box-sizing: border-box; font-size: 16px; }

        /* Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© */
        #invoice { display: none; background: white; padding: 40px; border: 2px solid #333; width: 800px; margin: 20px auto; }
        @media print {
            body * { visibility: hidden; }
            #invoice, #invoice * { visibility: visible; }
            #invoice { position: absolute; left: 0; top: 0; display: block; }
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… */
        .admin-panel { background: #f0f0f0; padding: 20px; border-radius: 15px; margin-top: 40px; border: 2px dashed var(--gold); }
        .admin-input { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; }

        /* Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ */
        .cart-status { position: fixed; bottom: 20px; right: 20px; background: var(--navy); color: white; padding: 15px 25px; border-radius: 50px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); z-index: 1000; }
    </style>
</head>
<body>

<div class="header">
    <div class="logo-container" id="logo_area">
        <img id="main_logo" src="https://i.ibb.co/C3YFp0k7/688339f4-1296-48c0-bc66-3be039832675.png" alt="Ø´Ø¹Ø§Ø± Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ">
    </div>
    <h1 style="margin:10px 0 0 0; color:var(--navy);">Ø®ÙŠØ§Ø· Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ«</h1>
    <p>Ø¥Ø±Ø« Ø§Ù„Ø£Ù†Ø§Ù‚Ø© Ù…Ù†Ø° 2002</p>
</div>

<div class="container">
    <div class="tabs">
        <button class="tab-btn active" onclick="openTab('shop', this)">ğŸ  Ø§Ù„Ù…ØªØ¬Ø±</button>
        <button class="tab-btn" onclick="openTab('tailor', this)">ğŸ“ ØªÙØµÙŠÙ„ Ø®Ø§Øµ</button>
        <button class="tab-btn" onclick="openTab('about', this)">ğŸ“œ Ù…Ù† Ù†Ø­Ù†</button>
        <button class="tab-btn" style="background:#333; color:white;" onclick="openTab('admin', this)">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
    </div>

    <div id="shop" class="section active">
        <h3>Ø§Ù„Ø£Ù‚Ù…Ø´Ø© ÙˆØ§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</h3>
        <div class="grid" id="product_display">
            </div>
    </div>

    <div id="tailor" class="section">
        <h3>ğŸ“ Ø£Ø¯Ø®Ù„ Ù…Ù‚Ø§Ø³Ø§ØªÙƒ (Ø¨Ø§Ù„Ù‡Ù†Ø´)</h3>
        <div class="measure-grid">
            <div><label>Ø§Ù„Ø·ÙˆÙ„</label><input type="number" step="0.1" id="m_len" class="measure-input"></div>
            <div><label>Ø§Ù„ÙƒØªÙ</label><input type="number" step="0.1" id="m_sh" class="measure-input"></div>
            <div><label>Ø§Ù„ÙŠØ¯</label><input type="number" step="0.1" id="m_hand" class="measure-input"></div>
            <div><label>Ø§Ù„Ø±Ù‚Ø¨Ø©</label><input type="number" step="0.1" id="m_neck" class="measure-input"></div>
            <div><label>Ø§Ù„ØµØ¯Ø±</label><input type="number" step="0.1" id="m_chest" class="measure-input"></div>
            <div><label>Ø§Ù„ÙˆØ³Ø·</label><input type="number" step="0.1" id="m_waist" class="measure-input"></div>
            <div><label>Ø§Ù„ÙƒØ¨Ùƒ</label><input type="number" step="0.1" id="m_cuff" class="measure-input"></div>
            <div><label>Ø§Ù„ÙˆØ³Ø¹</label><input type="number" step="0.1" id="m_wide" class="measure-input"></div>
        </div>
        <hr>
        <h3>ğŸ¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø«ÙˆØ¨</h3>
        <div class="measure-grid">
            <select id="t_neck" class="measure-input"><option>Ø±Ù‚Ø¨Ø© Ù‚Ù„Ø§Ø¨</option><option>Ø³Ø¹ÙˆØ¯ÙŠ</option><option>ÙƒÙˆÙŠØªÙŠ</option></select>
            <select id="t_hand" class="measure-input"><option>Ø³Ø§Ø¯Ø©</option><option>ÙƒØ¨Ùƒ</option></select>
            <select id="t_button" class="measure-input"><option>Ø£Ø²Ø±Ø§Ø± Ø¸Ø§Ù‡Ø±Ø©</option><option>ÙƒØ¨Ø³ Ù…Ø®ÙÙŠ</option></select>
            <input type="text" id="t_fabric" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ù…Ø§Ø´ Ø§Ù„Ù…Ø®ØªØ§Ø±" class="measure-input">
        </div>
        <button class="tab-btn active" style="width:100%; margin-top:20px;" onclick="generateInvoice()">Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙˆØ§Ù„Ø·Ù„Ø¨</button>
    </div>

    <div id="about" class="section">
        <h2>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. Ø®ÙŠØ·ÙŒ Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠØŒ ÙˆÙ†Ø³ÙŠØ¬ÙŒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</h2>
        <p>ØªØ£Ø³Ø³ Ù…Ø­Ù„ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ ÙÙŠ Ø¹Ø§Ù… 2002 Ø¹Ù„Ù‰ ÙŠØ¯ Ø§Ù„ÙˆØ§Ù„Ø¯ Ø±Ø­Ù…Ù‡ Ø§Ù„Ù„Ù‡ØŒ Ù„ÙŠÙƒÙˆÙ† Ø±Ù…Ø²Ø§Ù‹ Ù„Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„Ø±ÙÙŠØ¹Ø© ÙÙŠ Ø§Ù„Ø®ÙŠØ§Ø·Ø© Ø§Ù„Ø±Ø¬Ø§Ù„ÙŠØ©. Ù†Ø­Ù† Ù†Ø¯Ù…Ø¬ Ø§Ù„Ø®Ø¨Ø±Ø© Ø§Ù„Ø¹Ù…ÙŠÙ‚Ø© Ù…Ø¹ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ø­Ø¯ÙŠØ«Ø© Ù„Ù†ØµÙ„ Ø¥Ù„ÙŠÙƒ Ø£ÙŠÙ†Ù…Ø§ ÙƒÙ†Øª.</p>
    </div>

    <div id="admin" class="section">
        <div class="admin-panel">
            <h3>âš™ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø¯ÙŠØ±</h3>
            <p>Ø£Ø¶Ù Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ (Ø¬Ø§Ù‡Ø² Ø£Ùˆ Ù‚Ù…Ø§Ø´):</p>
            <input type="text" id="p_title" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" class="admin-input">
            <input type="number" id="p_price" placeholder="Ø§Ù„Ø³Ø¹Ø±" class="admin-input">
            <input type="file" id="p_img" class="admin-input" onchange="encodeImg(this)">
            <button class="tab-btn active" onclick="saveProduct()">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬ ÙÙŠ Ø§Ù„Ù…ØªØ¬Ø±</button>
            <hr>
            <p>ØªØºÙŠÙŠØ± Ø´Ø¹Ø§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹:</p>
            <input type="file" onchange="changeLogo(this)">
        </div>
    </div>
</div>

<div class="cart-status">
    Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù„Ø©: <span id="cart_total">0</span> Ø±ÙŠØ§Ù„
</div>

<div id="invoice">
    <div style="text-align:center;">
        <h2>ÙØ§ØªÙˆØ±Ø© ØªÙØµÙŠÙ„ - Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø©</h2>
        <p>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨: <span id="inv_date"></span></p>
    </div>
    <hr>
    <h4>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª (Ù„Ù„Ù…Ø´ØºÙ„):</h4>
    <table border="1" width="100%" style="text-align:center; border-collapse:collapse;">
        <tr><td>Ø§Ù„Ø·ÙˆÙ„</td><td id="v_len"></td><td>Ø§Ù„ÙƒØªÙ</td><td id="v_sh"></td></tr>
        <tr><td>Ø§Ù„ÙŠØ¯</td><td id="v_hand"></td><td>Ø§Ù„Ø±Ù‚Ø¨Ø©</td><td id="v_neck"></td></tr>
        <tr><td>Ø§Ù„ØµØ¯Ø±</td><td id="v_chest"></td><td>Ø§Ù„ÙƒØ¨Ùƒ</td><td id="v_cuff"></td></tr>
    </table>
    <h4>Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„ÙÙ†ÙŠØ©:</h4>
    <p>Ø§Ù„Ø±Ù‚Ø¨Ø©: <span id="v_t_neck"></span> | Ø§Ù„Ø£ÙƒÙ…Ø§Ù…: <span id="v_t_hand"></span> | Ø§Ù„Ø®ÙŠØ§Ø·Ø©: <span id="v_t_btn"></span></p>
    <p>Ø§Ù„Ù‚Ù…Ø§Ø´: <span id="v_t_fab"></span></p>
    <hr>
    <h3 style="text-align:left;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: <span id="v_total"></span> Ø±ÙŠØ§Ù„</h3>
    <p style="font-size:12px;">* Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¶Ù…Ø§Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ ÙŠØ´Ù…Ù„ Ø¯Ù‚Ø© Ø§Ù„Ù…Ù‚Ø§Ø³ ÙˆØ§Ù„Ù„ÙˆÙ† Ø§Ù„Ù…Ø®ØªØ§Ø±.</p>
</div>

<script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase (ÙŠØ±Ø¬Ù‰ ÙˆØ¶Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø´Ø±ÙˆØ¹Ùƒ Ù‡Ù†Ø§)
    const firebaseConfig = { databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com/" };
    if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let currentImg = "";
    let totalAmount = 0;

    function openTab(id, btn) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª
    function encodeImg(input) {
        const file = input.files[0];
        const reader = new FileReader();
        reader.onloadend = () => currentImg = reader.result;
        reader.readAsDataURL(file);
    }

    function saveProduct() {
        const title = document.getElementById('p_title').value;
        const price = document.getElementById('p_price').value;
        if(!title || !price || !currentImg) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        
        db.ref('products').push({ title, price, img: currentImg });
        alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­");
        location.reload();
    }

    function changeLogo(input) {
        const reader = new FileReader();
        reader.onload = (e) => {
            document.getElementById('main_logo').src = e.target.result;
            localStorage.setItem('yarmouk_logo', e.target.result);
        };
        reader.readAsDataURL(input.files[0]);
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
    db.ref('products').on('value', (snap) => {
        const data = snap.val();
        const display = document.getElementById('product_display');
        display.innerHTML = "";
        for(let id in data) {
            display.innerHTML += `
                <div class="card">
                    <img src="${data[id].img}">
                    <h4>${data[id].title}</h4>
                    <p class="price">${data[id].price} Ø±ÙŠØ§Ù„</p>
                    <button onclick="addToCart(${data[id].price})">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ù„Ø©</button>
                    <button style="background:red; color:white; border:none; padding:5px; margin-top:5px; border-radius:5px; cursor:pointer;" onclick="deleteItem('${id}')">Ø­Ø°Ù</button>
                </div>
            `;
        }
    });

    function deleteItem(id) {
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")) db.ref('products').child(id).remove();
    }

    function addToCart(p) {
        totalAmount += parseInt(p);
        document.getElementById('cart_total').innerText = totalAmount;
    }

    // Ù†Ø¸Ø§Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©
    function generateInvoice() {
        // ØªØ¹Ø¨Ø¦Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©
        document.getElementById('v_len').innerText = document.getElementById('m_len').value;
        document.getElementById('v_sh').innerText = document.getElementById('m_sh').value;
        document.getElementById('v_hand').innerText = document.getElementById('m_hand').value;
        document.getElementById('v_neck').innerText = document.getElementById('m_neck').value;
        document.getElementById('v_chest').innerText = document.getElementById('m_chest').value;
        document.getElementById('v_cuff').innerText = document.getElementById('m_cuff').value;
        document.getElementById('v_t_neck').innerText = document.getElementById('t_neck').value;
        document.getElementById('v_t_hand').innerText = document.getElementById('t_hand').value;
        document.getElementById('v_t_btn').innerText = document.getElementById('t_button').value;
        document.getElementById('v_t_fab').innerText = document.getElementById('t_fabric').value;
        document.getElementById('v_total').innerText = totalAmount;
        document.getElementById('inv_date').innerText = new Date().toLocaleDateString();

        window.print();
    }

    // Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸
    if(localStorage.getItem('yarmouk_logo')) {
        document.getElementById('main_logo').src = localStorage.getItem('yarmouk_logo');
    }
</script>

</body>
</html>
