<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© | Ø¥Ø±Ø«ÙŒ Ù…Ù† Ø§Ù„ÙØ®Ø§Ù…Ø©</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --white: #ffffff; --dark: #1a1a1a; --soft-gold: #fcf9f0; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 0; direction: rtl; color: var(--dark); }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…Ù„ÙƒÙŠ */
        .royal-header { background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('https://i.ibb.co/C3YFp0k7/688339f4-1296-48c0-bc66-3be039832675.png'); background-size: cover; background-position: center; color: white; text-align: center; padding: 50px 20px; border-bottom: 4px solid var(--gold); }
        #main_logo { width: 110px; height: 110px; border-radius: 50%; border: 3px solid var(--gold); background: white; padding: 5px; margin-bottom: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }

        .main-container { max-width: 600px; margin: -30px auto 20px; background: var(--white); border-radius: 25px; box-shadow: 0 15px 50px rgba(0,0,0,0.15); overflow: hidden; position: relative; z-index: 10; padding-bottom: 30px; }
        
        .cust-data { padding: 20px; background: #fff9eb; border-bottom: 1px solid #f0e6d2; }
        .cust-data input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; }

        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px; }
        .measure-grid input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; font-size: 13px; }
        .measure-grid label { font-size: 11px; display: block; text-align: center; font-weight: bold; color: var(--brown); }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© */
        .add-btn-large { width: calc(100% - 40px); margin: 15px 20px; padding: 20px; background: white; border: 2px dashed var(--gold); color: var(--gold); border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 16px; transition: 0.3s; }
        .add-btn-large:hover { background: var(--soft-gold); }

        /* Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…Ù„ÙˆÙ†Ø© */
        .pay-box { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 20px; }
        .bank-card { padding: 15px; border-radius: 15px; text-align: center; color: white; cursor: pointer; position: relative; }
        .kuraimi { background: #0056b3; } /* Ù„ÙˆÙ† Ø¨Ù†Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ */
        .jeeb { background: #f39c12; } /* Ù„ÙˆÙ† Ù…Ø­ÙØ¸Ø© Ø¬ÙŠØ¨ */
        .acc-num { display: block; margin-top: 5px; font-weight: bold; text-decoration: underline; font-size: 14px; letter-spacing: 1px; }

        /* Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ */
        .total-box { margin: 20px; padding: 25px; background: var(--brown); color: white; border-radius: 20px; text-align: center; }
        
        /* Ø²Ø± Ø§Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ù†ÙØµÙ„ */
        .submit-container { padding: 0 20px 20px 20px; }
        .btn-confirm { width: 100%; padding: 20px; background: #2e7d32; color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

        /* Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .product-modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:5000; overflow-y:auto; padding:20px; box-sizing:border-box; }
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .item-card { background: white; border-radius: 12px; overflow: hidden; text-align: center; padding-bottom: 10px; }
        .item-card img { width: 100%; height: 150px; object-fit: cover; }

        /* ÙŠØ§Ù‚ÙˆØª */
        .yaqoot-btn { position: fixed; bottom: 20px; left: 20px; background: var(--dark); color: var(--gold); border: 2px solid var(--gold); border-radius: 50px; padding: 12px 20px; cursor: pointer; z-index: 1000; font-weight: bold; }
        .yaqoot-chat { display: none; position: fixed; bottom: 80px; left: 20px; width: 300px; height: 400px; background: white; border: 2px solid var(--gold); border-radius: 20px; z-index: 1001; flex-direction: column; overflow: hidden; }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© */
        #adminPanel { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:white; z-index:10000; padding:20px; overflow-y:auto; }
    </style>
</head>
<body>

<div class="royal-header">
    <img src="" id="main_logo">
    <h2 id="store_name" style="margin:0;">Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ« Ù„Ù„Ø®ÙŠØ§Ø·Ø©</h2>
    <p style="color: var(--gold); font-size: 13px;">Ø¥Ø±Ø«ÙŒ Ù…Ù† Ø§Ù„ÙØ®Ø§Ù…Ø© Ù…Ù†Ø° 2002</p>
</div>

<div class="main-container">
    <div class="cust-data">
        <input type="text" id="c_name" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø±Ø¨Ø§Ø¹ÙŠ">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (ÙˆØ§ØªØ³Ø§Ø¨)">
        
        <div class="measure-grid">
            <div><label>Ø·ÙˆÙ„</label><input type="number" class="m-val"></div>
            <div><label>ÙƒØªÙ</label><input type="number" class="m-val"></div>
            <div><label>ÙŠØ¯</label><input type="number" class="m-val"></div>
            <div><label>ØµØ¯Ø±</label><input type="number" class="m-val"></div>
            <div><label>Ø±Ù‚Ø¨Ø©</label><input type="number" class="m-val"></div>
            <div><label>ÙˆØ³Ø·</label><input type="number" class="m-val"></div>
            <div><label>ÙƒØ¨Ùƒ</label><input type="number" class="m-val"></div>
            <div><label>Ø®Ø·ÙˆØ©</label><input type="number" class="m-val"></div>
        </div>
    </div>

    <button class="add-btn-large" onclick="openProducts('fabric')">â• Ø¥Ø¶Ø§ÙØ© Ù‚Ù…Ø§Ø´ ØªÙØµÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
    <button class="add-btn-large" onclick="openProducts('ready')">â• Ø¥Ø¶Ø§ÙØ© (Ø¬Ø§Ù‡Ø²ØŒ Ø´ÙŠÙ„Ø§Ù†ØŒ Ø£ÙƒÙˆØ§Øª)</button>

    <div id="cart_area" style="padding: 0 20px;"></div>

    <div class="pay-box">
        <div class="bank-card kuraimi" onclick="copy('3005374854')">
            <span style="font-size: 12px;">Ø¨Ù†Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ</span>
            <span class="acc-num" id="acc_k">3005374854</span>
            <small style="font-size: 9px; opacity: 0.8;">Ø§Ø¶ØºØ· Ù„Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…</small>
        </div>
        <div class="bank-card jeeb" onclick="copy('595720')">
            <span style="font-size: 12px;">Ù…Ø­ÙØ¸Ø© Ø¬ÙŠØ¨</span>
            <span class="acc-num" id="acc_j">595720</span>
            <small style="font-size: 9px; opacity: 0.8;">Ø§Ø¶ØºØ· Ù„Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…</small>
        </div>
    </div>

    <div style="padding: 0 20px;">
        <label style="font-size: 12px; font-weight: bold;">ğŸ“¸ Ø¥Ø±ÙØ§Ù‚ Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„:</label>
        <input type="file" id="receipt_img" style="width: 100%; margin-top: 5px;">
    </div>

    <div class="total-box">
        <div style="font-size: 14px; opacity: 0.9;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ­Ù‚:</div>
        <h2 style="margin: 5px 0;"><span id="total_price">0</span> Ø±ÙŠØ§Ù„</h2>
        <div id="discount_note" style="font-size: 11px; color: var(--gold);"></div>
    </div>

    <div class="submit-container">
        <button class="btn-confirm" onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ù‡ÙŠØ¨Ø© Ø§Ù„Ø·Ù„Ø¨ ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡</button>
    </div>
</div>

<div class="yaqoot-btn" onclick="toggleYaqoot()">âœ¨ Ø§Ø³Ø£Ù„ ÙŠØ§Ù‚ÙˆØª</div>
<div id="yaqoot_chat" class="yaqoot-chat">
    <div style="background:var(--brown); color:white; padding:12px; font-weight:bold; display:flex; justify-content:space-between;">
        <span>ğŸ’ ÙŠØ§Ù‚ÙˆØª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</span>
        <span onclick="toggleYaqoot()" style="cursor:pointer">Ã—</span>
    </div>
    <div id="chat_messages" style="flex:1; padding:15px; overflow-y:auto; font-size:13px; background:#f9f9f9;"></div>
    <div style="padding:10px; display:flex; gap:5px; border-top:1px solid #eee;">
        <input type="text" id="chat_input" placeholder="Ø§Ø³Ø£Ù„ ÙŠØ§Ù‚ÙˆØª Ø¹Ù† Ø£ÙŠ Ø´ÙŠØ¡..." style="flex:1; padding:10px; border-radius:20px; border:1px solid #ddd;">
        <button onclick="askYaqoot()" style="background:var(--gold); border:none; color:white; border-radius:50%; width:35px; height:35px;">â—€</button>
    </div>
</div>

<div id="productModal" class="product-modal">
    <div style="display:flex; justify-content:space-between; color:white; margin-bottom:20px;">
        <h3>Ù‚Ø§Ø¦Ù…Ø© Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</h3>
        <button onclick="closeProducts()" style="background:red; color:white; border:none; padding:10px; border-radius:5px;">Ø¥ØºÙ„Ø§Ù‚ X</button>
    </div>
    <div id="product_list" class="product-grid"></div>
</div>

<div id="adminPanel">
    <h3>âš™ï¸ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</h3>
    <input type="file" id="logo_up" onchange="uploadLogo(this)" style="margin-bottom:20px;">
    <div style="background:#eee; padding:15px; border-radius:15px;">
        <select id="adm_cat"><option value="fabric">Ù‚Ù…Ø§Ø´</option><option value="ready">Ø¬Ø§Ù‡Ø²</option></select>
        <input type="text" id="adm_name" placeholder="Ø§Ù„Ø§Ø³Ù…">
        <input type="number" id="adm_price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
        <input type="file" id="adm_file" onchange="encodeImg(this)">
        <button onclick="saveProduct()" style="width:100%; padding:10px; background:green; color:white;">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    <div id="admin_list" style="margin-top:20px;"></div>
    <button onclick="closeAdmin()" style="width:100%; margin-top:20px;">Ø®Ø±ÙˆØ¬</button>
</div>

<button onclick="checkAdmin()" style="position:fixed; bottom:5px; left:5px; opacity:0.1; border:none; background:none;">âš™ï¸</button>

<script>
const firebaseConfig = { databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com/" };
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

let allProducts = [];
let cart = [];
let tempImg = "";

// Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
database.ref('settings/logo').on('value', s => document.getElementById('main_logo').src = s.val());
database.ref('products').on('value', s => {
    allProducts = []; const data = s.val();
    if(data) for(let id in data) allProducts.push({...data[id], id});
    renderAdmin();
});

function copy(txt) { navigator.clipboard.writeText(txt); alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ù‚Ù…: " + txt); }

function openProducts(cat) {
    const list = document.getElementById('product_list');
    const filtered = allProducts.filter(p => p.cat === cat);
    list.innerHTML = filtered.map(p => `
        <div class="item-card">
            <img src="${p.img}">
            <b>${p.name}</b><br>
            <span style="color:green;">${p.price} Ø±ÙŠØ§Ù„</span><br>
            <button onclick="addToCart('${p.id}')" style="background:var(--gold); color:white; border:none; padding:5px 10px; border-radius:5px; margin-top:5px;">Ø¥Ø¶Ø§ÙØ©</button>
        </div>
    `).join('');
    document.getElementById('productModal').style.display='block';
}
function closeProducts() { document.getElementById('productModal').style.display='none'; }

function addToCart(id) {
    const p = allProducts.find(x => x.id === id);
    cart.push({...p});
    renderCart();
    closeProducts();
}

function renderCart() {
    const area = document.getElementById('cart_area');
    area.innerHTML = cart.map((p, i) => `
        <div style="background:white; border:1px solid #ddd; padding:10px; border-radius:10px; margin-bottom:5px; display:flex; align-items:center;">
            <img src="${p.img}" style="width:40px; height:40px; border-radius:5px; margin-left:10px;">
            <div style="flex:1; font-size:12px;"><b>${p.name}</b></div>
            <button onclick="cart.splice(${i},1); renderCart();" style="background:red; color:white; border:none; border-radius:50%;">Ã—</button>
        </div>
    `).join('');
    let total = cart.reduce((s, item) => s + parseInt(item.price), 0);
    document.getElementById('total_price').innerText = total.toLocaleString();
}

function submitOrder() {
    const name = document.getElementById('c_name').value;
    if(!name || cart.length === 0) return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");

    // Ø±Ø³Ø§Ù„Ø© Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£Ù†ÙŠÙ‚Ø©
    alert(`âœ¨ ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ ÙŠØ§ Ø³ÙŠØ¯ ${name} âœ¨\n\nÙ†Ø­Ù† ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ ÙØ®ÙˆØ±ÙˆÙ† Ø¨Ø§Ø®ØªÙŠØ§Ø±Ùƒ Ù„Ø¥Ø±Ø«Ù†Ø§. Ø³Ù†Ù‚ÙˆÙ… Ø§Ù„Ø¢Ù† Ø¨Ù†Ù‚Ù„Ùƒ Ù„Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù„ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©.\n\nØ´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒ Ø¨Ù†Ø§!`);

    let msg = `*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ«*%0AğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${name}%0AğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('total_price').innerText} Ø±ÙŠØ§Ù„%0AğŸ“¦ Ø§Ù„Ø£ØµÙ†Ø§Ù: ${cart.length}`;
    window.open(`https://wa.me/9677XXXXXXXX?text=${msg}`);
}

// ÙŠØ§Ù‚ÙˆØª
function toggleYaqoot() { const c = document.getElementById('yaqoot_chat'); c.style.display = c.style.display === 'flex' ? 'none' : 'flex'; }
function askYaqoot() {
    const inp = document.getElementById('chat_input');
    const msg = inp.value; if(!msg) return;
    const chat = document.getElementById('chat_messages');
    chat.innerHTML += `<div style="text-align:left; color:var(--gold); margin-bottom:10px;">ğŸ‘¤ ${msg}</div>`;
    inp.value = "";
    setTimeout(() => {
        chat.innerHTML += `<div style="background:#eee; padding:8px; border-radius:8px; margin-bottom:10px;">ğŸ’ Ù†Ø¹ØªØ² Ø¨Ø³Ø¤Ø§Ù„Ùƒ ÙŠØ§ ØºØ§Ù„ÙŠ. ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù†Ù‡ØªÙ… Ø¨ÙƒÙ„ ØºØ±Ø²Ø© Ù„ØªÙ„ÙŠÙ‚ Ø¨Ù…Ù‚Ø§Ù…Ùƒ. Ø«ÙˆØ¨Ùƒ ÙŠÙ…Ø± Ø¨Ù€ 4 Ù…Ø±Ø§Ø­Ù„ Ù…Ù† Ø§Ù„Ù‚Øµ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ù„Ù„ÙƒØ§ÙˆÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù‡ÙŠØ¨Ø©.</div>`;
        chat.scrollTop = chat.scrollHeight;
    }, 600);
}

// Ø¥Ø¯Ø§Ø±Ø©
function checkAdmin() { if(prompt("Pass:") === "1234") document.getElementById('adminPanel').style.display='block'; }
function closeAdmin() { document.getElementById('adminPanel').style.display='none'; }
function encodeImg(i) { const r = new FileReader(); r.onload = e => tempImg = e.target.result; r.readAsDataURL(i.files[0]); }
function saveProduct() {
    const name = document.getElementById('adm_name').value;
    const price = document.getElementById('adm_price').value;
    const cat = document.getElementById('adm_cat').value;
    database.ref('products').push({name, price, cat, img: tempImg}).then(() => alert("ØªÙ…!"));
}
function uploadLogo(i) { const r = new FileReader(); r.onload = e => database.ref('settings/logo').set(e.target.result); r.readAsDataURL(i.files[0]); }
function renderAdmin() {
    document.getElementById('admin_list').innerHTML = allProducts.map(p => `<div>${p.name} <button onclick="database.ref('products/${p.id}').remove()">Ø­Ø°Ù</button></div>`).join('');
}
</script>
</body>
</html>
