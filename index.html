<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© - Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --white: #ffffff; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 10px; direction: rtl; }
        .main-container { max-width: 600px; margin: auto; background: var(--white); border-radius: 20px; border: 1px solid var(--gold); box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; position: relative; }
        
        /* Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-banner { background: var(--brown); color: white; padding: 12px; text-align: center; font-size: 13px; border-bottom: 2px solid var(--gold); }
        .heritage-box { padding: 15px; background: #fffdf5; border-bottom: 1px solid #eee; text-align: center; font-size: 14px; color: #555; line-height: 1.6; }
        
        .header { text-align: center; padding: 15px; border-bottom: 2px solid var(--gold); }
        .cust-info { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; background: #fff9eb; }
        .cust-info input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; width: 100%; box-sizing: border-box;}
        
        .main-tabs { display: flex; background: #eee; }
        .tab-btn { flex: 1; padding: 15px; border: none; cursor: pointer; font-weight: bold; background: #eee; color: #666; }
        .tab-btn.active { background: var(--gold); color: white; }
        .section { display: none; padding: 15px; }
        .section.active { display: block; }

        /* Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª */
        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 15px 0; background: #f9f9f9; padding: 10px; border-radius: 10px; }
        .measure-grid label { font-size: 11px; color: var(--brown); font-weight: bold; display: block; margin-bottom: 4px; }
        .measure-grid input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; box-sizing: border-box; }

        /* ÙŠØ§Ù‚ÙˆØª */
        .yaqoot-box { background: #e3f2fd; border-right: 4px solid #1e88e5; padding: 10px; border-radius: 8px; font-size: 13px; margin-bottom: 15px; }
        
        /* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .items-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .product-card { border: 1px solid #eee; border-radius: 12px; overflow: hidden; background: white; text-align: center; padding-bottom: 10px; position: relative; }
        .product-card img { width: 100%; height: 120px; object-fit: cover; }
        
        .selected-thobe-card { background: #fff9eb; border: 1px solid var(--gold); border-radius: 15px; padding: 15px; margin-bottom: 15px; position: relative; }
        .remove-card { position: absolute; top: 10px; left: 10px; background: #ff4d4d; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; }
        .thobe-opt { width: 100%; padding: 8px; border-radius: 8px; border: 1px solid #ddd; font-size: 12px; margin-top: 5px; background: white; }

        /* Ø§Ù„Ø¯ÙØ¹ */
        .payment-box { padding: 15px; border: 1px solid #ddd; border-radius: 12px; margin-top: 15px; background: #fcfcfc; }
        
        .btn-send { width: 100%; padding: 18px; background: var(--brown); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 20px; cursor: pointer; }
        .settings-btn { position: fixed; bottom: 80px; left: 20px; background: var(--white); border: 1px solid var(--gold); border-radius: 50%; width: 45px; height: 45px; cursor: pointer; font-size: 20px; z-index: 1000; }
        
        .overlay-panel { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:10000; justify-content:center; align-items:center; }
        .admin-box { background:#222; color:white; padding:20px; border-radius:15px; width:90%; max-width:400px; border:2px solid var(--gold); }
        .admin-input { width: 100%; padding: 10px; margin-bottom: 8px; border-radius: 6px; border: 1px solid #444; background: #333; color: white; box-sizing: border-box; }
        .del-badge { position: absolute; top: 5px; right: 5px; background: red; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 12px; }
    </style>
</head>
<body>

<div class="welcome-banner">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. "Ø¥Ø±Ø« Ø§Ù„ÙˆØ§Ù„Ø¯ ÙŠØ±Ø­Ø¨ Ø¨Ùƒ" âœ¨</div>
<div class="heritage-box">
    <strong>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. Ø®ÙŠØ·ÙŒ Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠØŒ ÙˆÙ†Ø³ÙŠØ¬ÙŒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</strong><br>
    Ù…Ù†Ø° 2002ØŒ Ù†ØµÙ†Ø¹ Ù‡ÙŠØ¨ØªÙƒ Ø¨Ø¯Ù‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ ÙˆØ®Ø¨Ø±Ø© Ø§Ù„Ø³Ù†ÙŠÙ†.
</div>

<button class="settings-btn" onclick="openAdmin()">âš™ï¸</button>

<div class="main-container">
    <div class="header">
        <h2 style="margin:0; color:var(--brown)">Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ«</h2>
        <div id="yaqoot_msg" class="yaqoot-box">ğŸ’ <b>ÙŠØ§Ù‚ÙˆØª:</b> Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ! ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ ÙˆÙ…Ù‚Ø§Ø³Ø§ØªÙƒ Ù„Ù†Ø¨Ø¯Ø£ ØªÙØµÙŠÙ„ Ø£Ù†Ø§Ù‚ØªÙƒ.</div>
    </div>

    <div class="cust-info">
        <input type="text" id="c_name" placeholder="Ø¥Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    </div>

    <div class="main-tabs">
        <button class="tab-btn active" id="btn_tailor" onclick="switchMainTab('tailor')">Ø§Ù„ØªÙØµÙŠÙ„ ÙˆØ§Ù„Ø£Ù‚Ù…Ø´Ø©</button>
        <button class="tab-btn" id="btn_ready" onclick="switchMainTab('ready')">Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</button>
    </div>

    <div id="section_tailor" class="section active">
        <h4 style="margin:0 0 10px 0; color:var(--brown)">ğŸ“ Ù…Ù‚Ø§Ø³Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø¨Ø§Ù„Ù‡Ù†Ø´)</h4>
        <div class="measure-grid">
            <div><label>Ø§Ù„Ø·ÙˆÙ„</label><input type="number" step="0.1" class="m-input" data-name="Ø·ÙˆÙ„"></div>
            <div><label>Ø§Ù„ÙƒØªÙ</label><input type="number" step="0.1" class="m-input" data-name="ÙƒØªÙ"></div>
            <div><label>Ø·ÙˆÙ„ Ø§Ù„ÙŠØ¯</label><input type="number" step="0.1" class="m-input" data-name="ÙŠØ¯"></div>
            <div><label>ÙˆØ³Ø¹ Ø§Ù„ØµØ¯Ø±</label><input type="number" step="0.1" class="m-input" data-name="ØµØ¯Ø±"></div>
            <div><label>Ø§Ù„Ø±Ù‚Ø¨Ø©</label><input type="number" step="0.1" class="m-input" data-name="Ø±Ù‚Ø¨Ø©"></div>
            <div><label>ÙˆØ³Ø· Ø§Ù„ÙŠØ¯</label><input type="number" step="0.1" class="m-input" data-name="ÙˆØ³Ø· ÙŠØ¯"></div>
            <div><label>Ø·ÙˆÙ„ Ø§Ù„ÙƒØ¨Ùƒ</label><input type="number" step="0.1" class="m-input" data-name="ÙƒØ¨Ùƒ"></div>
            <div><label>ÙˆØ³Ø¹ Ø§Ù„Ø®Ø·ÙˆØ©(ØªØ­Øª)</label><input type="number" step="0.1" class="m-input" data-name="Ø®Ø·ÙˆØ©"></div>
        </div>
        <button type="button" style="width:100%; padding:15px; background:#fff; border:2px dashed var(--gold); border-radius:12px; color:var(--gold); font-weight:bold; cursor:pointer;" onclick="openFabricModal()">+ Ø¥Ø¶Ø§ÙØ© Ø«ÙˆØ¨ ØªÙØµÙŠÙ„ Ø¬Ø¯ÙŠØ¯</button>
        <div id="tailor_list" style="margin-top:15px;"></div>
    </div>

    <div id="section_ready" class="section">
        <div id="ready_display" class="items-grid"></div>
    </div>

    <div class="payment-box">
        <h4 style="margin:0 0 10px 0;">ğŸ’³ ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ÙØ¶Ù„Ø©:</h4>
        <select id="selected_payment" class="thobe-opt" style="font-size:14px; padding:10px;">
            <option value="ÙƒØ§Ø´ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…">Ù†Ù‚Ø¯Ù‹Ø§ (Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…)</option>
            <option value="ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ">ØªØ­ÙˆÙŠÙ„ Ø¨Ù†ÙƒÙŠ (Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ/Ø§Ù„Ø¨Ø³ÙŠØ±ÙŠ)</option>
            <option value="Ù…Ø­ÙØ¸Ø© Ø¬ÙˆØ§Ù„">Ù…Ø­ÙØ¸Ø© Ø¬ÙˆØ§Ù„ (M-Pesa/Ø£Ø®Ø±Ù‰)</option>
        </select>
    </div>

    <div style="background:var(--brown); color:white; padding:20px; text-align:center;">
        <h3 style="margin:0;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="final_total">0</span> Ø±ÙŠØ§Ù„</h3>
    </div>
    <button type="button" class="btn-send" onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
</div>

<div id="adminPanel" class="overlay-panel">
    <div class="admin-box">
        <h3 style="color:var(--gold); margin-top:0;">Ø¥Ø¯Ø§Ø±Ø© Ù…Ø®Ø²Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</h3>
        <select id="adm_cat" class="admin-input">
            <option value="fabric">Ù‚Ù…Ø§Ø´ ØªÙØµÙŠÙ„</option>
            <option value="ready">Ù…Ù†ØªØ¬ Ø¬Ø§Ù‡Ø²</option>
        </select>
        <input type="file" id="adm_file" class="admin-input" onchange="encodeImg(this)">
        <input type="text" id="adm_title" class="admin-input" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ù…Ø§Ø´/Ø§Ù„Ù…Ù†ØªØ¬">
        <textarea id="adm_desc" class="admin-input" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"></textarea>
        <div style="display:flex; gap:5px;">
            <input type="number" id="adm_old" class="admin-input" placeholder="Ø§Ù„Ø³Ø¹Ø± Ù‚Ø¨Ù„">
            <input type="number" id="adm_new" class="admin-input" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø¹Ø¯">
        </div>
        <button onclick="saveProduct()" style="width:100%; padding:15px; background:var(--gold); color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©</button>
        <button onclick="closeAdmin()" style="width:100%; background:none; border:none; color:#ccc; margin-top:10px; cursor:pointer;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<div id="fabricModal" class="overlay-panel">
    <div style="background:white; width:95%; max-width:400px; padding:20px; border-radius:15px;">
        <h3 style="text-align:center; color:var(--brown);">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ù…Ø§Ø´</h3>
        <div id="modal_fabric_list" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; max-height:350px; overflow-y:auto;"></div>
        <button onclick="document.getElementById('fabricModal').style.display='none'" style="width:100%; margin-top:15px; padding:10px; border:none; border-radius:8px; background:#eee;">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
</div>

<script>
    let db = JSON.parse(localStorage.getItem('yarmouk_db')) || { fabrics: [], ready: [] };
    let tempImg = ""; let readyCartTotal = 0; let readyCartItems = [];

    window.onload = () => { filterReady(); };

    function syncStorage() {
        localStorage.setItem('yarmouk_db', JSON.stringify(db));
        filterReady();
    }

    function openAdmin() { if(prompt("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === "1234") document.getElementById('adminPanel').style.display='flex'; }
    function closeAdmin() { document.getElementById('adminPanel').style.display='none'; }
    
    function encodeImg(i) { 
        let r = new FileReader(); 
        r.onload = (e) => { tempImg = e.target.result; }; 
        if(i.files[0]) r.readAsDataURL(i.files[0]); 
    }

    function saveProduct() {
        const title = document.getElementById('adm_title').value;
        const price = document.getElementById('adm_new').value;
        const cat = document.getElementById('adm_cat').value;

        if (!title || !price || !tempImg) {
            alert("ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø± ÙˆØ§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©");
            return;
        }

        const item = { 
            id: Date.now(), title, 
            desc: document.getElementById('adm_desc').value, 
            oldPrice: document.getElementById('adm_old').value || "0", 
            newPrice: price, 
            img: tempImg, 
            cat: cat 
        };
        
        if(cat === 'fabric') db.fabrics.push(item);
        else db.ready.push(item);
        
        syncStorage();
        alert("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø¨Ù†Ø¬Ø§Ø­");
        
        if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¢Ø®Ø±ØŸ")) {
            // ØªØµÙÙŠØ± Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù„Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
            document.getElementById('adm_title').value = "";
            document.getElementById('adm_desc').value = "";
            document.getElementById('adm_old').value = "";
            document.getElementById('adm_new').value = "";
            document.getElementById('adm_file').value = "";
            tempImg = "";
            document.getElementById('adm_file').click();
        } else {
            closeAdmin();
        }
    }

    function switchMainTab(t) {
        document.querySelectorAll('.section, .tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById('section_'+t).classList.add('active');
        document.getElementById('btn_'+t).classList.add('active');
    }

    function openFabricModal() {
        const list = document.getElementById('modal_fabric_list');
        document.getElementById('fabricModal').style.display = 'flex';
        list.innerHTML = db.fabrics.length ? db.fabrics.map(f => `
            <div style="border:1px solid #eee; padding:5px; text-align:center; border-radius:10px; cursor:pointer;" onclick="confirmFabricSelection('${f.title}', ${f.newPrice}, '${f.img}')">
                <img src="${f.img}" style="width:100%; height:80px; object-fit:cover; border-radius:5px;">
                <div style="font-size:11px; font-weight:bold; margin-top:5px;">${f.title}</div>
                <div style="font-size:10px; color:green;">${f.newPrice} Ø±ÙŠØ§Ù„</div>
            </div>
        `).join('') : '<p style="grid-column:1/-1; text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù‚Ù…Ø´Ø© ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©</p>';
    }

    function confirmFabricSelection(name, price, img) {
        let colorInfo = prompt("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ÙˆÙ† Ù„Ù„Ù‚Ù…Ø§Ø´ Ø£Ùˆ ÙƒØªØ§Ø¨Ø© Ø±Ù‚Ù… Ø§Ù„Ù‚Ù…Ø§Ø´:");
        if(!colorInfo) return;

        const id = Date.now();
        const card = document.createElement('div');
        card.className = 'selected-thobe-card';
        card.id = `thobe_${id}`;
        card.innerHTML = `
            <button type="button" class="remove-card" onclick="removeThobe(${id})">Ã—</button>
            <div style="display:flex; gap:10px; align-items:center;">
                <img src="${img}" style="width:50px; height:50px; object-fit:cover; border-radius:8px;">
                <div><b>Ù‚Ù…Ø§Ø´: ${name} (${colorInfo})</b><br><span style="color:green; font-weight:bold;">${price} Ø±ÙŠØ§Ù„</span></div>
            </div>
            
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:12px;">
                <div><label style="font-size:10px;">Ù†ÙˆØ¹ Ø§Ù„Ø±Ù‚Ø¨Ø©</label>
                <select class="thobe-opt"><option>Ù‚Ù„Ø§Ø¨ Ù…Ù„ÙƒÙŠ</option><option>Ù‚Ù„Ø§Ø¨ ÙØ±Ù†Ø³ÙŠ</option><option>Ù‚Ù„Ø§Ø¨ Ø¯Ø§Ø¦Ø±ÙŠ</option><option>Ø³Ø§Ø¯Ø© Ù…Ø±Ø¨Ø¹</option><option>Ø³Ø§Ø¯Ø© Ø¯Ø§Ø¦Ø±ÙŠ</option><option>ØµÙŠÙ†ÙŠ</option></select></div>
                
                <div><label style="font-size:10px;">Ù†ÙˆØ¹ Ø§Ù„ÙƒØ¨Ùƒ</label>
                <select class="thobe-opt"><option>ÙƒØ¨Ùƒ Ù‚Ù…Ø§Ø´</option><option>ÙƒØ¨Ùƒ Ø­Ø´Ùˆ Ù…Ø±Ø¨Ø¹</option><option>ÙƒØ¨Ùƒ Ø­Ø´Ùˆ Ø¯Ø§Ø¦Ø±ÙŠ</option><option>Ø³Ø§Ø¯Ø© Ø¨Ø¯ÙˆÙ† Ø²Ø±Ø§Ø±</option></select></div>
                
                <div><label style="font-size:10px;">Ø§Ù„Ø¬Ø¨Ø²ÙˆØ±</label>
                <select class="thobe-opt"><option>ÙƒØ¨Ø³ Ø¸Ø§Ù‡Ø±</option><option>Ø²Ø±Ø§Ø± Ù…Ø®ÙÙŠ</option><option>Ø³Ø­Ø§Ø¨ VIP</option></select></div>
                
                <div><label style="font-size:10px;">Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø®ÙŠØ§Ø·Ø©</label>
                <select class="thobe-opt"><option>Ù‚Ø·Ø±ÙŠ</option><option>Ø³Ø¹ÙˆØ¯ÙŠ</option><option>Ø¹Ù…Ø§Ù†ÙŠ</option><option>ÙƒÙˆÙŠØªÙŠ</option></select></div>
            </div>
            <textarea class="thobe-opt" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø«ÙˆØ¨..." style="height:45px; margin-top:10px;"></textarea>
            <input type="hidden" class="item-price" value="${price}">
        `;
        document.getElementById('tailor_list').appendChild(card);
        calcGrandTotal();
        document.getElementById('fabricModal').style.display = 'none';
        document.getElementById('yaqoot_msg').innerText = "ğŸ’ ÙŠØ§Ù‚ÙˆØª: Ø§Ø®ØªÙŠØ§Ø± Ø±Ø§Ø¦Ø¹! Ù‡Ù„ ØªØ±ØºØ¨ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø«ÙˆØ¨ Ø¢Ø®Ø± Ø£Ù… Ù†Ù†ØªÙ‚Ù„ Ù„Ù„Ø¯ÙØ¹ØŸ";
    }

    function filterReady() {
        const display = document.getElementById('ready_display');
        display.innerHTML = db.ready.length ? db.ready.map(i => `
            <div class="product-card">
                <button class="del-badge" onclick="deleteItem('ready', ${i.id})">Ã—</button>
                <img src="${i.img}">
                <div style="padding:5px; font-weight:bold; font-size:13px;">${i.title}</div>
                <div style="font-size:10px; color:#888; padding:0 5px;">${i.desc}</div>
                <div style="color:red; text-decoration:line-through; font-size:11px;">${i.oldPrice} Ø±ÙŠØ§Ù„</div>
                <div style="color:green; font-weight:bold; font-size:14px;">${i.newPrice} Ø±ÙŠØ§Ù„</div>
                <button onclick="addReadyToCart(${i.newPrice}, '${i.title}')" style="width:90%; background:var(--gold); color:white; border:none; border-radius:5px; padding:6px; margin:5px 0; cursor:pointer; font-weight:bold;">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø·Ù„Ø¨</button>
            </div>
        `).join('') : '<p style="grid-column:1/-1; text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø§Ù‡Ø²Ø©</p>';
    }

    function addReadyToCart(p, name) { 
        readyCartTotal += parseInt(p); 
        readyCartItems.push(name); 
        calcGrandTotal(); 
        document.getElementById('yaqoot_msg').innerText = "ğŸ’ ÙŠØ§Ù‚ÙˆØª: ØªÙ… Ø¥Ø¶Ø§ÙØ© " + name + " Ù„Ø³Ù„ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­.";
    }

    function deleteItem(type, id) {
        if(confirm("Ø­Ø°Ù Ø§Ù„Ø¹Ù†ØµØ± Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
            if(type === 'ready') db.ready = db.ready.filter(x => x.id !== id);
            else db.fabrics = db.fabrics.filter(x => x.id !== id);
            syncStorage();
        }
    }

    function removeThobe(id) { document.getElementById(`thobe_${id}`).remove(); calcGrandTotal(); }

    function calcGrandTotal() {
        let t = readyCartTotal;
        document.querySelectorAll('.item-price').forEach(i => t += parseInt(i.value || 0));
        document.getElementById('final_total').innerText = t.toLocaleString();
    }

    function submitOrder() {
        const name = document.getElementById('c_name').value;
        const phone = document.getElementById('c_phone').value;
        if (!name || !phone) return alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨");

        let measures = {};
        document.querySelectorAll('.m-input').forEach(input => {
            measures[input.getAttribute('data-name')] = input.value || "0";
        });

        let tailorOrders = [];
        document.querySelectorAll('.selected-thobe-card').forEach(card => {
            let opts = Array.from(card.querySelectorAll('select')).map(s => s.value).join(' | ');
            let note = card.querySelector('textarea').value;
            tailorOrders.push(card.querySelector('b').innerText + " [Ø®ÙŠØ§Ø·Ø©: " + opts + "] Ù…Ù„Ø§Ø­Ø¸Ø©: " + note);
        });

        const orderData = { 
            whatsapp: "967737039088", 
            name, phone, 
            measures,
            tailor: tailorOrders, 
            ready: readyCartItems, 
            payment: document.getElementById('selected_payment').value,
            total: document.getElementById('final_total').innerText 
        };

        fetch('https://ali991278.app.n8n.cloud/webhook-test/e4bcc169-93c0-42c5-8226-528f3c6a72e3', {
            method: 'POST', mode: 'no-cors', headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(orderData)
        }).then(() => {
            alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­ Ø¥Ù„Ù‰ Ø®ÙŠØ§Ø· Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ! Ø³ØªØµÙ„Ùƒ Ø±Ø³Ø§Ù„Ø© ØªØ£ÙƒÙŠØ¯ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ù‚Ø±ÙŠØ¨Ø§Ù‹.");
            location.reload();
        });
    }
</script>
</body>
</html>
