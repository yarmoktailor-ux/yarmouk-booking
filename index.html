<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© - Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ 2026</title>
    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --white: #ffffff; --dark: #1a1a1a; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 10px; direction: rtl; }
        
        .main-container { max-width: 600px; margin: auto; background: var(--white); border-radius: 20px; border: 1px solid var(--gold); box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ ÙˆÙ‚ØµØ© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ */
        .welcome-banner { background: var(--brown); color: white; padding: 15px; text-align: center; font-size: 13px; border-bottom: 2px solid var(--gold); }
        .heritage-box { padding: 15px; background: #fffdf5; border-bottom: 1px solid #eee; text-align: center; font-size: 14px; color: #555; line-height: 1.6; }

        .header { text-align: center; padding: 20px; border-bottom: 2px solid var(--gold); background: white; }
        .logo { width: 140px; margin-bottom: 10px; border-radius: 10px; }
        
        .cust-info { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; background: #fff9eb; }
        .cust-info input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; width: 100%; box-sizing: border-box; transition: 0.3s; }
        .cust-info input:focus { border-color: var(--gold); }

        .main-tabs { display: flex; background: #eee; }
        .tab-btn { flex: 1; padding: 15px; border: none; cursor: pointer; font-weight: bold; background: #eee; color: #666; transition: 0.3s; font-size: 14px; }
        .tab-btn.active { background: var(--gold); color: white; }

        .section { display: none; padding: 15px; }
        .section.active { display: block; }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª */
        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 15px 0; background: #f9f9f9; padding: 10px; border-radius: 10px; border: 1px solid #eee; }
        .measure-grid div { text-align: center; }
        .measure-grid label { font-size: 11px; color: var(--brown); font-weight: bold; display: block; margin-bottom: 4px; }
        .measure-grid input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; box-sizing: border-box; font-size: 13px; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¬Ø§Ù‡Ø²Ø© */
        .ready-nav { display: flex; gap: 5px; margin-bottom: 15px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; }
        .ready-type-btn { padding: 8px 18px; border: 1px solid var(--gold); border-radius: 50px; background: white; white-space: nowrap; cursor: pointer; font-size: 12px; font-weight: bold; transition: 0.3s; }
        .ready-type-btn.active { background: var(--brown); color: white; border-color: var(--brown); }
        
        .items-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .product-card { border: 1px solid #eee; border-radius: 15px; overflow: hidden; background: white; text-align: center; padding-bottom: 10px; transition: 0.3s; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .product-card:hover { transform: translateY(-5px); }
        .product-card img { width: 100%; height: 160px; object-fit: cover; }
        .new-price { color: #28a745; font-weight: bold; font-size: 15px; display: block; margin: 5px 0; }

        /* Ø¨ÙˆØª ÙŠØ§Ù‚ÙˆØª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ */
        .yaqoot-btn { position: fixed; bottom: 85px; left: 20px; background: var(--dark); color: var(--gold); border: 2px solid var(--gold); border-radius: 50px; padding: 12px 25px; cursor: pointer; z-index: 1000; font-weight: bold; box-shadow: 0 5px 15px rgba(0,0,0,0.3); transition: 0.3s; display: flex; align-items: center; gap: 8px; }
        .yaqoot-btn:hover { transform: scale(1.05); }
        .yaqoot-chat { display: none; position: fixed; bottom: 145px; left: 20px; width: 280px; background: white; border: 2px solid var(--gold); border-radius: 20px; z-index: 1001; box-shadow: 0 10px 40px rgba(0,0,0,0.3); overflow: hidden; animation: slideUp 0.3s ease; }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* Ø§Ù„Ø¶Ù…Ø§Ù† */
        .guarantee-box { margin: 15px; padding: 15px; background: #fffdf0; border: 1px dashed var(--gold); border-radius: 12px; font-size: 12px; color: #785e1a; line-height: 1.6; }

        /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
        .btn-send { width: 100%; padding: 18px; background: var(--brown); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 20px; cursor: pointer; transition: 0.3s; }
        .btn-send:hover { background: #452f28; }
        .settings-btn { position: fixed; bottom: 20px; left: 20px; background: var(--white); border: 1px solid var(--gold); border-radius: 50%; width: 55px; height: 55px; cursor: pointer; font-size: 26px; z-index: 1000; box-shadow: 0 4px 10px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        .settings-btn:hover { transform: rotate(90deg); }
        
        /* ØªØ¬Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ© */
        .selected-thobe-card { background: #fff9eb; border: 1px solid var(--gold); border-radius: 15px; padding: 15px; margin-bottom: 15px; position: relative; box-shadow: 0 4px 12px rgba(212, 175, 55, 0.1); }
        .remove-card { position: absolute; top: -10px; left: -10px; background: #ff4d4d; color: white; border: none; border-radius: 50%; width: 28px; height: 28px; cursor: pointer; font-weight: bold; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
        .thobe-opt { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd; font-size: 12px; margin-top: 5px; background: white; cursor: pointer; }
        
        .pay-card-ui { cursor: pointer; transition: 0.3s; }
        .pay-card-ui:hover { transform: translateY(-2px); }
        .pay-card-ui.active div { border-color: var(--gold) !important; background: #fff9eb !important; }
    </style>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

</head>
<body>

<div class="welcome-banner">
    Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. "Ø¥Ø±Ø« Ø§Ù„ÙˆØ§Ù„Ø¯ ÙŠØ±Ø­Ø¨ Ø¨Ùƒ" âœ¨
</div>

<div class="heritage-box">
    <strong>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. Ø®ÙŠØ·ÙŒ Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠØŒ ÙˆÙ†Ø³ÙŠØ¬ÙŒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</strong><br>
    Ù…Ù†Ø° 2002ØŒ Ù†ØµÙ†Ø¹ Ù‡ÙŠØ¨ØªÙƒ Ø¨Ø¯Ù‚Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ ÙˆØ®Ø¨Ø±Ø© Ø§Ù„Ø³Ù†ÙŠÙ†. Ù†Ø­Ù† Ù„Ø§ Ù†Ø®ÙŠØ· Ø£Ø«ÙˆØ§Ø¨Ø§Ù‹ØŒ Ù†Ø­Ù† Ù†ØµÙ†Ø¹ Ø­Ø¶ÙˆØ±Ùƒ.
</div>

<button class="settings-btn" onclick="openAdmin()">âš™ï¸</button>

<div class="yaqoot-btn" onclick="toggleYaqoot()">âœ¨ ÙŠØ§Ù‚ÙˆØª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</div>
<div id="yaqoot_chat" class="yaqoot-chat">
    <div style="background:var(--brown); color:white; padding:12px; font-weight:bold; display:flex; justify-content:space-between; align-items:center;">
        <span>ÙŠØ§Ù‚ÙˆØª - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</span>
        <span onclick="toggleYaqoot()" style="cursor:pointer">Ã—</span>
    </div>
    <div style="padding:15px; font-size:13px; line-height:1.6;" id="chat_text">
        Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø±Ø­Ø§Ø¨ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ! Ø£Ù†Ø§ ÙŠØ§Ù‚ÙˆØª.. Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ù†Ø§Ù‚Ø© Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ. ÙƒÙŠÙ Ø£Ø®Ø¯Ù…Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ
        <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
        <button onclick="yaqootReply('policy')" style="width:100%; margin-bottom:8px; padding:8px; border-radius:8px; border:1px solid var(--gold); background:white; cursor:pointer;">ğŸ›¡ï¸ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¶Ù…Ø§Ù†</button>
        <button onclick="yaqootReply('offer')" style="width:100%; padding:8px; border-radius:8px; border:1px solid var(--gold); background:white; cursor:pointer;">ğŸ Ù‡Ø¯Ø§ÙŠØ§ Ø§Ù„ÙƒØ§Ø´</button>
        <button onclick="yaqootReply('about')" style="width:100%; margin-top:8px; padding:8px; border-radius:8px; border:1px solid var(--gold); background:white; cursor:pointer;">ğŸ“œ Ù‚ØµØ© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</button>
    </div>
</div>

<div class="main-container" id="app_body">
    <div class="header">
        <img src="https://i.ibb.co/C3YFp0k7/688339f4-1296-48c0-bc66-3be039832675.png" class="logo" id="store_logo" alt="Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ">
        <h2 style="margin:0; color:var(--brown); letter-spacing:1px;">Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ«</h2>
    </div>

    <div class="cust-info">
        <input type="text" id="c_name" placeholder="Ø¥Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    </div>

    <div class="main-tabs">
        <button class="tab-btn active" onclick="switchMainTab('tailor')">Ø§Ù„ØªÙØµÙŠÙ„ ÙˆØ§Ù„Ø£Ù‚Ù…Ø´Ø©</button>
        <button class="tab-btn" onclick="switchMainTab('ready')">Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</button>
    </div>

    <div id="section_tailor" class="section active">
        <h4 style="margin:0 0 10px 0; color:var(--brown); display:flex; align-items:center; gap:5px;">ğŸ“ Ù…Ù‚Ø§Ø³Ø§ØªÙƒ Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© (Ø¨Ø§Ù„Ù‡Ù†Ø´)</h4>
        <div class="measure-grid">
            <div><label>Ø§Ù„Ø·ÙˆÙ„</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ÙƒØªÙ</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ÙŠØ¯</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ØµØ¯Ø±</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„Ø±Ù‚Ø¨Ø©</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>ÙˆØ³Ø· ÙŠØ¯</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ÙƒØ¨Ùƒ</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„Ø®Ø·ÙˆØ©</label><input type="number" step="0.1" class="m-input"></div>
        </div>
        <button type="button" style="width:100%; padding:18px; background:#fff; border:2px dashed var(--gold); border-radius:15px; color:var(--gold); font-weight:bold; cursor:pointer; font-size:16px;" onclick="openFabricModal()">+ Ø§Ø®ØªØ± Ø§Ù„Ù‚Ù…Ø§Ø´ ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„ØªÙØµÙŠÙ„</button>
        <div id="tailor_list" style="margin-top:20px;"></div>
    </div>

    <div id="section_ready" class="section">
        <div class="ready-nav">
            <button class="ready-type-btn active" onclick="filterReady('all', this)">Ø§Ù„ÙƒÙ„</button>
            <button class="ready-type-btn" onclick="filterReady('thobe_r', this)">ğŸ‘• Ø«ÙŠØ§Ø¨ Ø¬Ø§Ù‡Ø²Ø©</button>
            <button class="ready-type-btn" onclick="filterReady('coat_r', this)">ğŸ§¥ Ø£ÙƒÙˆØ§Øª</button>
            <button class="ready-type-btn" onclick="filterReady('shawl_r', this)">ğŸ§£ Ø´ÙŠÙ„Ø§Ù†</button>
        </div>
        <div id="ready_display" class="items-grid">
            <p style="text-align:center; grid-column:1/-1; color:#999; padding:20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª Ø¬Ø§Ù‡Ø²Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>
        </div>
    </div>

    <div class="guarantee-box">
        ğŸ›¡ï¸ <strong>Ø¶Ù…Ø§Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø°Ù‡Ø¨ÙŠ:</strong> Ù†Ø¶Ù…Ù† Ù„Ùƒ Ø¯Ù‚Ø© Ø§Ù„Ù…Ù‚Ø§Ø³ Ø¨Ø§Ù„Ù…Ù„ÙŠ. ÙÙŠ Ø­Ø§Ù„ ÙˆØ¬ÙˆØ¯ Ø£ÙŠ Ø§Ø®ØªÙ„Ø§Ù Ø¹Ù† Ø·Ù„Ø¨ÙƒØŒ Ù†ØªØ­Ù…Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ ÙÙˆØ±Ø§Ù‹ Ù…Ø¹ Ø´Ø­Ù† Ù…Ø¬Ø§Ù†ÙŠ. Ø±Ø¶Ø§Ùƒ Ù‡Ùˆ Ø®ÙŠØ·Ù†Ø§ Ø§Ù„Ø£ÙˆÙ„.
    </div>

    <div style="padding:15px; background:#fff; border-top:5px solid #eee;">
        <h4 style="margin:0 0 10px 0; color:var(--brown); font-size:14px;">ğŸ’³ Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</h4>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="pay-card-ui" onclick="selectPayment('Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ', 'Ø­Ø³Ø§Ø¨ Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ: 3005374854', this)">
                <div style="font-size:12px; font-weight:bold; color:#1a5eb8; text-align:center; padding:12px; border:1px solid #ddd; border-radius:12px;">Ø¨Ù†Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…ÙŠ</div>
            </div>
            <div class="pay-card-ui" onclick="selectPayment('Ù…Ø­ÙØ¸Ø© Ø¬ÙŠØ¨', 'Ø±Ù‚Ù… Ø§Ù„Ù†Ù‚Ø·Ø©: 595720', this)">
                <div style="font-size:12px; font-weight:bold; color:#f39c12; text-align:center; padding:12px; border:1px solid #ddd; border-radius:12px;">Ù…Ø­ÙØ¸Ø© Ø¬ÙŠØ¨</div>
            </div>
        </div>
        
        <div id="account_display" style="display:none; background:#fffdf5; border:1px dashed var(--gold); padding:15px; border-radius:12px; text-align:center; margin-top:15px;">
            <div id="account_number" style="font-size:16px; font-weight:bold; color:var(--brown);"></div>
        </div>

        <div id="receipt_section" style="display:none; margin-top:15px; padding:15px; border:1px solid #eee; border-radius:12px; background:#fafafa;">
            <label style="font-size:12px; font-weight:bold; color:#555; display:block; margin-bottom:8px;">ğŸ“¸ Ø¥Ø±ÙØ§Ù‚ ØµÙˆØ±Ø© Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„:</label>
            <input type="file" id="receipt_file" accept="image/*" onchange="encodeReceipt(this)" style="font-size:12px; width:100%;">
        </div>
        <input type="hidden" id="selected_payment" value="Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ¯">
    </div>

    <div style="background:var(--brown); color:white; padding:25px; text-align:center; border-radius:0 0 20px 20px;">
        <h3 style="margin:0; font-weight:lighter; opacity:0.9;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ø£Ù†Ø§Ù‚ØªÙƒ</h3>
        <h2 style="margin:10px 0 0 0;"><span id="final_total">0</span> Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ</h2>
        <button type="button" class="btn-send" onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ù‡ÙŠØ¨Ø© Ø§Ù„Ø·Ù„Ø¨</button>
    </div>
</div>

<div id="adminPanel" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); z-index:10000; justify-content:center; align-items:center;">
    <div style="background:#222; color:white; padding:25px; border-radius:20px; width:90%; max-width:400px; border:1px solid var(--gold);">
        <h3 style="color:var(--gold); margin-top:0;">Ø¥Ø¯Ø§Ø±Ø© Ù…ØªØ¬Ø± Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</h3>
        <select id="adm_cat" style="width:100%; padding:12px; margin-bottom:12px; border-radius:8px;">
            <option value="fabric">Ø¥Ø¶Ø§ÙØ© Ù‚Ù…Ø§Ø´ ØªÙØµÙŠÙ„</option>
            <option value="thobe_r">Ø«ÙˆØ¨ Ø¬Ø§Ù‡Ø²</option>
            <option value="coat_r">ÙƒÙˆØª Ø¬Ø§Ù‡Ø²</option>
            <option value="shawl_r">Ø´Ø§Ù„ Ø¬Ø§Ù‡Ø²</option>
            <option value="logo">ØªØºÙŠÙŠØ± Ø§Ù„Ø´Ø¹Ø§Ø±</option>
        </select>
        <input type="file" id="adm_file" onchange="encodeImg(this)" style="margin-bottom:12px; width:100%;">
        <input type="text" id="adm_title" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬/Ø§Ù„Ù‚Ù…Ø§Ø´" style="width:100%; padding:12px; margin-bottom:12px; border-radius:8px; border:none;">
        <input type="number" id="adm_new" placeholder="Ø§Ù„Ø³Ø¹Ø± (Ø±ÙŠØ§Ù„)" style="width:100%; padding:12px; margin-bottom:12px; border-radius:8px; border:none;">
        <button onclick="saveToCloud()" style="width:100%; padding:15px; background:var(--gold); color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">Ù†Ø´Ø± Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¢Ù†</button>
        <button onclick="closeAdmin()" style="width:100%; background:none; border:none; color:#999; margin-top:15px; cursor:pointer;">Ø¥Ù„ØºØ§Ø¡ ÙˆØ¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<div id="fabricModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85); z-index:9999; justify-content:center; align-items:center;">
    <div style="background:white; width:90%; max-width:450px; padding:25px; border-radius:20px; max-height:80vh; overflow-y:auto;">
        <h3 style="text-align:center; color:var(--brown); margin-top:0;">Ø£Ù‚Ù…Ø´Ø© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„ÙØ§Ø®Ø±Ø©</h3>
        <div id="modal_fabric_list" style="display:grid; grid-template-columns:1fr 1fr; gap:12px;"></div>
        <button onclick="document.getElementById('fabricModal').style.display='none'" style="width:100%; margin-top:20px; padding:12px; border:none; border-radius:10px; background:#eee; font-weight:bold; cursor:pointer;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<script>
    let db = { fabrics: [], ready: [] };
    let tempImg = ""; let receiptImg = "";
    let readyCartTotal = 0;

    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨ÙˆØª ÙŠØ§Ù‚ÙˆØª
    function toggleYaqoot() {
        const chat = document.getElementById('yaqoot_chat');
        chat.style.display = chat.style.display === 'block' ? 'none' : 'block';
    }

    function yaqootReply(type) {
        const text = document.getElementById('chat_text');
        if(type === 'policy') {
            text.innerHTML = "<b>ğŸ›¡ï¸ Ø¶Ù…Ø§Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ:</b> Ù†Ø¶Ù…Ù† Ù„Ùƒ Ø§Ù„Ù…Ù‚Ø§Ø³ 100%. Ø¥Ø°Ø§ ÙˆØ¬Ø¯ Ø£ÙŠ Ø§Ø®ØªÙ„Ø§ÙØŒ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù…Ø¬Ø§Ù†ÙŠ ØªÙ…Ø§Ù…Ø§Ù‹ Ø®Ù„Ø§Ù„ 3 Ø£ÙŠØ§Ù…. Ù‡ÙŠØ¨ØªÙƒ Ù„Ø§ ØªÙ‚Ø¨Ù„ Ø§Ù„Ø®Ø·Ø£.";
        } else if(type === 'offer') {
            text.innerHTML = "<b>ğŸ Ø¹Ø±Ø¶ Ø§Ù„ÙƒØ§Ø´:</b> Ø¹Ù†Ø¯ Ø¯ÙØ¹ ÙƒØ§Ù…Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ù…Ù‚Ø¯Ù…Ø§Ù‹ØŒ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ (ØªØ·Ø±ÙŠØ² ÙŠØ¯ÙˆÙŠ Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„Ø±Ù‚Ø¨Ø©) Ø£Ùˆ (Ø¹Ù„Ø¨Ø© ÙƒØ¨ÙƒØ§Øª ÙØ§Ø®Ø±Ø©) Ù‡Ø¯ÙŠØ© Ù…Ù† Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.";
        } else if(type === 'about') {
            text.innerHTML = "<b>ğŸ“œ Ù‚ØµØ© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ:</b> Ø¨Ø¯Ø£Øª Ø±Ø­Ù„ØªÙ†Ø§ ÙÙŠ 2002 Ø¹Ù„Ù‰ ÙŠØ¯ Ø§Ù„ÙˆØ§Ù„Ø¯ Ø§Ù„Ù…Ø¤Ø³Ø³ØŒ ØªØ¹Ù„Ù…Ù†Ø§ Ø£Ù† Ø§Ù„Ø«ÙˆØ¨ Ù„ÙŠØ³ Ù…Ø¬Ø±Ø¯ Ù‚Ø·Ø¹Ø© Ù‚Ù…Ø§Ø´ØŒ Ø¨Ù„ Ù‡Ùˆ Ø´Ø®ØµÙŠØ© Ø§Ù„Ø±Ø¬Ù„. Ù†Ø­Ù† Ù‡Ù†Ø§ Ù„Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø±Ø«.";
        }
    }

    // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    function openAdmin() {
    let pass = prompt("Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:");
    if (pass === "1234") {
        // Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„ÙØªØ­ Ø§Ù„Ù„ÙˆØ­Ø©
        document.getElementById('adminPanel').style.display = 'flex';
        
        // --- Ø¶Ø¹ Ø§Ù„Ø³Ø·Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù‡Ù†Ø§ ---
        document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'block');
        // ---------------------------
        
    } else {
        alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©!");
    }
}


    function closeAdmin() {
    document.getElementById('adminPanel').style.display = 'none';
    // Ø¥Ø®ÙØ§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø­Ø°Ù Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
    document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'none');
}

    function encodeImg(i) { let r = new FileReader(); r.onload = (e) => tempImg = e.target.result; r.readAsDataURL(i.files[0]); }
    function encodeReceipt(i) { let r = new FileReader(); r.onload = (e) => receiptImg = e.target.result; r.readAsDataURL(i.files[0]); }

    function switchMainTab(t) {
        document.querySelectorAll('.section, .tab-btn').forEach(el => el.classList.remove('active'));
        document.getElementById('section_'+t).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // 1. Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³Ø­Ø§Ø¨Ø©
const firebaseConfig = {
    databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com"
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();

// 2. Ø¯Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© (ØªÙØ±Ø¨Ø· Ø¨Ø²Ø± Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©)
function saveToCloud() {
    const cat = document.getElementById('adm_cat').value;
    const title = document.getElementById('adm_title').value;
    const newPrice = document.getElementById('adm_new').value;
    const oldPrice = document.getElementById('adm_old') ? document.getElementById('adm_old').value : 0;

    if (!tempImg || !title || !newPrice) {
        return alert("ÙŠØ±Ø¬Ù‰ Ø¥ÙƒÙ…Ø§Ù„ ÙƒØ§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØ§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø©");
    }

    // Ø±ÙØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø³Ø­Ø§Ø¨Ø©
    database.ref('products').push({
        cat: cat,
        title: title,
        newPrice: newPrice,
        oldPrice: oldPrice,
        img: tempImg // Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© ÙƒÙƒÙˆØ¯ Ù†ØµÙŠ Ø³Ø­Ø§Ø¨ÙŠ
    }).then(() => {
        alert("ØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø© Ø¨Ù†Ø¬Ø§Ø­ âœ…");
        closeAdmin();
    }).catch((error) => {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­ÙØ¸:", error);
        alert("ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø­Ø§Ø¨Ø©");
    });
}

// 3. Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ (ØªØ¹Ù…Ù„ ÙÙˆØ± ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹)
// Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø§Ù„Ù…Ø·ÙˆØ±Ø© Ù…Ø¹ Ù…ÙŠØ²Ø© Ø§Ù„Ø­Ø°Ù
// Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ù„Ø¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø¢Ù…Ù†Ø© Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ ÙƒØ§ÙØ© Ø§Ù„Ø£Ø²Ø±Ø§Ø±
database.ref('products').on('value', (snapshot) => {
    try {
        const data = snapshot.val();
        const fabricList = document.getElementById('modal_fabric_list');
        const readyDisplay = document.getElementById('ready_display');
        
        db.fabrics = []; 
        db.ready = [];
        
        if (fabricList) fabricList.innerHTML = '';
        if (readyDisplay) readyDisplay.innerHTML = '';

        if (data) {
            for (let id in data) {
                const item = data[id];
                item.s_id = id;

                if (item.cat === 'fabric') {
                    db.fabrics.push(item);
                    if (fabricList) {
                        fabricList.innerHTML += `
                            <div style="border:1px solid #eee; padding:10px; position:relative; text-align:center;">
                                <button onclick="deleteProduct('${id}')" style="position:absolute; top:2px; right:2px; background:red; color:white; border:none; border-radius:50%; width:20px; height:20px; cursor:pointer; z-index:100;">Ã—</button>
                                <img src="${item.img}" style="width:100%; height:80px; object-fit:cover; border-radius:5px;">
                                <div style="font-size:12px; margin-top:5px;">${item.title}</div>
                            </div>`;
                    }
                } else {
                    db.ready.push(item);
                    if (readyDisplay) {
                        readyDisplay.innerHTML += `
                            <div class="product-card" style="position:relative;">
                                 <button onclick="deleteProduct('${id}')" class="admin-only" style="display:none; position:absolute; top:5px; right:5px; background:red; color:white; border:none; padding:5px; border-radius:5px; cursor:pointer; z-index:100;">Ø­Ø°Ù</button>
                                 <img src="${item.img}">
                                 <b>${item.title}</b><br>
                                 <span>${item.newPrice} Ø±ÙŠØ§Ù„</span>
                                 <button onclick="addReadyToCart(${item.newPrice})" style="width:100%; background:var(--gold); border:none; color:white; padding:8px; margin-top:5px; cursor:pointer;">Ø¥Ø¶Ø§ÙØ©</button>
                            </div>`;
                    }
                }
            }
        }
    } catch (e) {
        console.error("Ø®Ø·Ø£ ÙÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ø­Ø§Ø¨ÙŠØ©: ", e);
    }
});


// Ø¯Ø§Ù„Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ø°Ù Ø§Ù„ÙØ¹Ù„ÙŠ Ù…Ù† Ø§Ù„Ø³Ø­Ø§Ø¨Ø©
function deleteProduct(productId) {
    if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø³Ø­Ø§Ø¨Ø© Ø§Ù„ÙŠØ±Ù…ÙˆÙƒØŸ")) {
        database.ref('products/' + productId).remove()
            .then(() => alert("ØªÙ… Ø§Ù„Ø­Ø°Ù Ø¨Ù†Ø¬Ø§Ø­ âœ…"))
            .catch(() => alert("ÙØ´Ù„ Ø§Ù„Ø­Ø°ÙØŒ ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„"));
    }
}

    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ ÙÙŠ Ø§Ù„ØµÙØ­Ø©
    if(typeof filterReady === "function") filterReady('all'); 
});


    function openFabricModal() {
        const list = document.getElementById('modal_fabric_list');
        list.innerHTML = db.fabrics.length ? db.fabrics.map(f => `
            <div style="border:1px solid #eee; padding:8px; text-align:center; cursor:pointer; border-radius:12px; transition:0.3s;" onclick="confirmFabricSelection('${f.title}', ${f.newPrice}, '${f.img}')">
                <img src="${f.img}" style="width:100%; height:80px; object-fit:cover; border-radius:8px;">
                <div style="font-size:11px; font-weight:bold; margin-top:5px;">${f.title}</div>
                <div style="font-size:11px; color:green;">${f.newPrice} Ø±ÙŠØ§Ù„</div>
            </div>
        `).join('') : '<p style="grid-column:1/-1; text-align:center;">ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ø£Ù‚Ù…Ø´Ø© Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø£ÙˆÙ„Ø§Ù‹</p>';
        document.getElementById('fabricModal').style.display = 'flex';
    }

    function confirmFabricSelection(name, price, img) {
        const id = Date.now();
        const card = document.createElement('div');
        card.className = 'selected-thobe-card';
        card.id = `thobe_${id}`;
        card.innerHTML = `
            <button type="button" class="remove-card" onclick="removeThobe(${id})">Ã—</button>
            <div style="display:flex; gap:12px; align-items:center;">
                <img src="${img}" style="width:50px; height:50px; border-radius:8px; object-fit:cover; border:1px solid var(--gold);">
                <div><b>Ø«ÙˆØ¨: ${name}</b><br><span style="color:green; font-size:13px;">${price} Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ</span></div>
            </div>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-top:15px;">
                <select class="thobe-opt"><option>Ù‚Ù„Ø§Ø¨ Ù…Ù„ÙƒÙŠ</option><option>Ù‚Ù„Ø§Ø¨ ÙØ±Ù†Ø³ÙŠ</option><option>ØµÙŠÙ†ÙŠ</option><option>Ø³Ø§Ø¯Ø© Ù…Ø±Ø¨Ø¹</option></select>
                <select class="thobe-opt"><option>ÙƒØ¨Ùƒ Ù‚Ù…Ø§Ø´</option><option>ÙƒØ¨Ùƒ Ø­Ø´Ùˆ</option><option>Ø³Ø§Ø¯Ø©</option></select>
                <select class="thobe-opt"><option>ÙƒØ¨Ø³ Ø¸Ø§Ù‡Ø±</option><option>Ø²Ø±Ø§Ø± Ù…Ø®ÙÙŠ</option><option>Ø³Ø­Ø§Ø¨ VIP</option></select>
                <select class="thobe-opt"><option>Ù‚ØµØ© Ù‚Ø·Ø±ÙŠØ©</option><option>Ù‚ØµØ© Ø³Ø¹ÙˆØ¯ÙŠØ©</option><option>Ù‚ØµØ© ÙƒÙˆÙŠØªÙŠØ©</option></select>
            </div>
            <input type="hidden" class="item-price" value="${price}">
        `;
        document.getElementById('tailor_list').appendChild(card);
        calcGrandTotal();
        document.getElementById('fabricModal').style.display = 'none';
    }

    function filterReady(type, btn) {
        if(btn) {
            document.querySelectorAll('.ready-type-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
        const display = document.getElementById('ready_display');
        const items = type === 'all' ? db.ready : db.ready.filter(i => i.cat === type);
        display.innerHTML = items.length ? items.map(i => `
            <div class="product-card">
                <img src="${i.img}">
                <div style="padding:10px;">
                    <div style="font-size:13px; font-weight:bold;">${i.title}</div>
                    <span class="new-price">${i.newPrice} Ø±ÙŠØ§Ù„</span>
                    <button onclick="addReadyToCart(${i.newPrice})" style="width:100%; margin-top:8px; background:var(--gold); border:none; color:white; border-radius:8px; font-size:12px; padding:8px; cursor:pointer; font-weight:bold;">Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø·Ù„Ø¨</button>
                </div>
            </div>
        `).join('') : '<p style="grid-column:1/-1; padding:20px;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…</p>';
    }

    function addReadyToCart(p) { readyCartTotal += parseInt(p); calcGrandTotal(); alert("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ù‡ÙŠØ¨ØªÙƒ"); }
    function removeThobe(id) { document.getElementById(`thobe_${id}`).remove(); calcGrandTotal(); }

    function calcGrandTotal() {
        let t = readyCartTotal;
        document.querySelectorAll('.item-price').forEach(i => t += parseInt(i.value || 0));
        document.getElementById('final_total').innerText = t.toLocaleString();
    }

    function selectPayment(m, d, el) {
        document.querySelectorAll('.pay-card-ui').forEach(c => c.classList.remove('active'));
        el.classList.add('active');
        document.getElementById('account_display').style.display = 'block';
        document.getElementById('account_number').innerText = d;
        document.getElementById('selected_payment').value = m + " (" + d + ")";
        document.getElementById('receipt_section').style.display = 'block';
    }

    function submitOrder() {
        const name = document.getElementById('c_name').value;
        const total = document.getElementById('final_total').innerText;
        if (!name || total === "0") return alert("Ø£ÙƒÙ…Ù„ Ø§Ø³Ù…Ùƒ ÙˆØ§Ø®ØªØ± Ø«ÙˆØ¨Ø§Ù‹ ÙŠÙ„ÙŠÙ‚ Ø¨Ùƒ Ø£ÙˆÙ„Ø§Ù‹");

        const orderData = {
            name: name,
            phone: document.getElementById('c_phone').value,
            total: total,
            payment: document.getElementById('selected_payment').value,
            date: new Date().toLocaleString('ar-YE'),
            source: "Ù…ØªØ¬Ø± Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ« 2026"
        };

        const webhookUrl = 'https://ali991278.app.n8n.cloud/webhook-test/e4bcc169-93c0-42c5-8226-528f3c6a72e3';
        
        fetch(webhookUrl, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(orderData)
        })
        .then(() => {
            alert("Ø§ÙƒØªÙ…Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­.\n\nØ³Ù†ØµÙ†Ø¹ Ø£Ù†Ø§Ù‚ØªÙƒ ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© Ø¨Ø¯Ù‚Ø© ØªÙ„ÙŠÙ‚ Ø¨Ùƒ.");
            location.reload();
        })
        .catch(() => alert("ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø·Ù„Ø¨Ùƒ.. Ø´ÙƒØ±Ø§Ù‹ Ù„Ø«Ù‚ØªÙƒ Ø¨Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ"));
    }
</script>
</body>
</html>
