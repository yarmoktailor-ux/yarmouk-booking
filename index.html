<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ù„Ù„Ø®ÙŠØ§Ø·Ø© - Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ 2026</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        :root { --gold: #d4af37; --brown: #5d4037; --bg: #fdfbf7; --white: #ffffff; --dark: #1a1a1a; --navy: #001F3F; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg); margin: 0; padding: 10px; direction: rtl; }
        
        .main-container { max-width: 600px; margin: auto; background: var(--white); border-radius: 20px; border: 1px solid var(--gold); box-shadow: 0 10px 30px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-banner { background: var(--navy); color: white; padding: 15px; text-align: center; font-size: 13px; border-bottom: 2px solid var(--gold); }
        .heritage-box { padding: 15px; background: #fffdf5; border-bottom: 1px solid #eee; text-align: center; font-size: 14px; color: #555; line-height: 1.6; }

        .header { text-align: center; padding: 20px; border-bottom: 2px solid var(--gold); background: white; }
        .logo { width: 140px; margin-bottom: 10px; border-radius: 10px; }
        
        .cust-info { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; background: #fff9eb; }
        .cust-info input { padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; width: 100%; box-sizing: border-box; transition: 0.3s; }

        .main-tabs { display: flex; background: #eee; }
        .tab-btn { flex: 1; padding: 15px; border: none; cursor: pointer; font-weight: bold; background: #eee; color: #666; font-size: 14px; }
        .tab-btn.active { background: var(--gold); color: white; }

        .section { display: none; padding: 15px; }
        .section.active { display: block; }

        /* Ø´Ø¨ÙƒØ© Ø§Ù„Ù…Ù‚Ø§Ø³Ø§Øª Ø¨Ø§Ù„Ù‡Ù†Ø´ */
        .measure-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; margin: 15px 0; background: #f9f9f9; padding: 10px; border-radius: 10px; border: 1px solid #eee; }
        .measure-grid label { font-size: 11px; color: var(--brown); font-weight: bold; display: block; margin-bottom: 4px; text-align: center; }
        .measure-grid input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px; text-align: center; font-size: 13px; }

        /* Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª */
        .items-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .product-card { border: 1px solid #eee; border-radius: 15px; overflow: hidden; background: white; text-align: center; padding-bottom: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .product-card img { width: 100%; height: 160px; object-fit: cover; }
        .new-price { color: #28a745; font-weight: bold; font-size: 15px; }

        /* Ø¨ÙˆØª ÙŠØ§Ù‚ÙˆØª */
        .yaqoot-btn { position: fixed; bottom: 85px; left: 20px; background: var(--dark); color: var(--gold); border: 2px solid var(--gold); border-radius: 50px; padding: 12px 25px; cursor: pointer; z-index: 1000; font-weight: bold; display: flex; align-items: center; gap: 8px; }
        .yaqoot-chat { display: none; position: fixed; bottom: 145px; left: 20px; width: 280px; background: white; border: 2px solid var(--gold); border-radius: 20px; z-index: 1001; box-shadow: 0 10px 40px rgba(0,0,0,0.3); overflow: hidden; }

        .btn-send { width: 100%; padding: 18px; background: var(--brown); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: bold; margin-top: 20px; cursor: pointer; }
        .settings-btn { position: fixed; bottom: 20px; left: 20px; background: var(--white); border: 1px solid var(--gold); border-radius: 50%; width: 55px; height: 55px; cursor: pointer; z-index: 1000; display: flex; align-items: center; justify-content: center; }
        
        .selected-thobe-card { background: #fff9eb; border: 1px solid var(--gold); border-radius: 15px; padding: 15px; margin-bottom: 15px; position: relative; }
        .remove-card { position: absolute; top: -10px; left: -10px; background: #ff4d4d; color: white; border: none; border-radius: 50%; width: 28px; height: 28px; cursor: pointer; }
        .thobe-opt { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ddd; font-size: 12px; margin-top: 5px; }
    </style>
</head>
<body>

<div class="welcome-banner">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. "Ø¥Ø±Ø« Ø§Ù„ÙˆØ§Ù„Ø¯ ÙŠØ±Ø­Ø¨ Ø¨Ùƒ" âœ¨</div>

<div class="heritage-box">
    <strong>Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ.. Ø®ÙŠØ·ÙŒ Ù…Ù† Ø§Ù„Ù…Ø§Ø¶ÙŠØŒ ÙˆÙ†Ø³ÙŠØ¬ÙŒ Ù„Ù„Ù…Ø³ØªÙ‚Ø¨Ù„</strong><br>
    Ù†Ø­Ù† Ù„Ø§ Ù†Ø®ÙŠØ· Ø£Ø«ÙˆØ§Ø¨Ø§Ù‹ØŒ Ù†Ø­Ù† Ù†ØµÙ†Ø¹ Ø­Ø¶ÙˆØ±Ùƒ.
</div>

<button class="settings-btn" onclick="openAdmin()">âš™ï¸</button>

<div class="yaqoot-btn" onclick="toggleYaqoot()">âœ¨ ÙŠØ§Ù‚ÙˆØª Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ</div>
<div id="yaqoot_chat" class="yaqoot-chat">
    <div style="background:var(--brown); color:white; padding:12px; font-weight:bold; display:flex; justify-content:space-between;">
        <span>ÙŠØ§Ù‚ÙˆØª - Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</span>
        <span onclick="toggleYaqoot()" style="cursor:pointer">Ã—</span>
    </div>
    <div style="padding:15px; font-size:13px;" id="chat_text">
        Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ! Ø£Ù†Ø§ ÙŠØ§Ù‚ÙˆØª Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ù†Ø§Ù‚Ø©. ÙƒÙŠÙ Ø£Ø®Ø¯Ù…ÙƒØŸ
        <button onclick="yaqootReply('policy')" style="width:100%; margin-top:10px; padding:8px; border:1px solid var(--gold); background:white;">ğŸ›¡ï¸ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¶Ù…Ø§Ù†</button>
        <button onclick="yaqootReply('offer')" style="width:100%; margin-top:5px; padding:8px; border:1px solid var(--gold); background:white;">ğŸ Ø¹Ø±ÙˆØ¶Ù†Ø§</button>
    </div>
</div>

<div class="main-container">
    <div class="header">
        <img src="https://i.ibb.co/C3YFp0k7/688339f4-1296-48c0-bc66-3be039832675.png" class="logo" alt="Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ">
        <h2 style="margin:0; color:var(--brown);">Ø§Ù„ÙŠØ±Ù…ÙˆÙƒ Ø§Ù„Ø­Ø¯ÙŠØ«</h2>
    </div>

    <div class="cust-info">
        <input type="text" id="c_name" placeholder="Ø¥Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
        <input type="tel" id="c_phone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
    </div>

    <div class="main-tabs">
        <button class="tab-btn active" id="tab_tailor" onclick="switchMainTab('tailor')">Ø§Ù„ØªÙØµÙŠÙ„ ÙˆØ§Ù„Ø£Ù‚Ù…Ø´Ø©</button>
        <button class="tab-btn" id="tab_ready" onclick="switchMainTab('ready')">Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</button>
    </div>

    <div id="section_tailor" class="section active">
        <h4 style="margin-bottom:10px;">ğŸ“ Ù…Ù‚Ø§Ø³Ø§ØªÙƒ (Ø¨Ø§Ù„Ù‡Ù†Ø´/Ø¨ÙˆØµØ©)</h4>
        <div class="measure-grid">
            <div><label>Ø§Ù„Ø·ÙˆÙ„</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ÙƒØªÙ</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ÙŠØ¯</label><input type="number" step="0.1" class="m-input"></div>
            <div><label>Ø§Ù„ØµØ¯Ø±</label><input type="number" step="0.1" class="m-input"></div>
        </div>
        <button onclick="openFabricModal()" style="width:100%; padding:15px; border:2px dashed var(--gold); background:white; color:var(--gold); font-weight:bold; cursor:pointer;">+ Ø§Ø®ØªØ± Ø§Ù„Ù‚Ù…Ø§Ø´</button>
        <div id="tailor_list" style="margin-top:20px;"></div>
    </div>

    <div id="section_ready" class="section">
        <div id="ready_display" class="items-grid"></div>
    </div>

    <div style="padding:15px; background:var(--navy); color:white; text-align:center;">
        Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="final_total" style="font-size:24px; font-bold;">0</span> Ø±ÙŠØ§Ù„
        <button class="btn-send" onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ù‡ÙŠØ¨Ø© Ø§Ù„Ø·Ù„Ø¨</button>
    </div>
</div>

<div id="fabricModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center;">
    <div style="background:white; width:90%; padding:20px; border-radius:15px;">
        <h3 style="text-align:center;">Ø§Ø®ØªØ± Ù‚Ù…Ø§Ø´Ùƒ Ø§Ù„ÙØ§Ø®Ø±</h3>
        <div id="modal_fabric_list" style="display:grid; grid-template-columns:1fr 1fr; gap:10px;"></div>
        <button onclick="document.getElementById('fabricModal').style.display='none'" style="width:100%; margin-top:15px; padding:10px;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
</div>

<div id="adminPanel" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:3000; justify-content:center; align-items:center;">
    <div style="background:#fff; padding:20px; border-radius:15px; width:80%;">
        <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
        <input type="text" id="adm_title" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" style="width:100%; margin-bottom:10px; padding:8px;">
        <input type="number" id="adm_new" placeholder="Ø§Ù„Ø³Ø¹Ø±" style="width:100%; margin-bottom:10px; padding:8px;">
        <select id="adm_cat" style="width:100%; margin-bottom:10px; padding:8px;">
            <option value="fabric">Ù‚Ù…Ø§Ø´ ØªÙØµÙŠÙ„</option>
            <option value="thobe_r">Ø¬Ø§Ù‡Ø²</option>
        </select>
        <input type="file" onchange="encodeImg(this)" style="margin-bottom:10px;">
        <button onclick="saveToCloud()" style="width:100%; padding:10px; background:var(--gold); color:white; border:none;">Ù†Ø´Ø± Ø§Ù„Ø¢Ù†</button>
        <button onclick="closeAdmin()" style="width:100%; margin-top:5px; border:none; background:none; color:red;">Ø¥Ù„ØºØ§Ø¡</button>
    </div>
</div>

<script>
// Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
const firebaseConfig = { databaseURL: "https://alyarmok-store-default-rtdb.firebaseio.com/" };
if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
const database = firebase.database();

let db = { fabrics: [], ready: [] };
let tempImg = "";
let readyCartTotal = 0;

// Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
database.ref('products').on('value', (snapshot) => {
    const data = snapshot.val();
    db.fabrics = []; db.ready = [];
    if (data) {
        for (let id in data) {
            if (data[id].cat === 'fabric') db.fabrics.push(data[id]);
            else db.ready.push(data[id]);
        }
    }
    renderReadyItems();
});

function switchMainTab(t) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.getElementById('section_' + t).classList.add('active');
    document.getElementById('tab_' + t).classList.add('active');
}

function openFabricModal() {
    const list = document.getElementById('modal_fabric_list');
    list.innerHTML = db.fabrics.map(f => `
        <div onclick="selectFabric('${f.title}', ${f.newPrice}, '${f.img}')" style="border:1px solid #eee; padding:5px; text-align:center; cursor:pointer;">
            <img src="${f.img}" style="width:100%; height:80px; object-fit:cover;">
            <div style="font-size:12px;">${f.title}</div>
            <div style="color:green;">${f.newPrice} Ø±.ÙŠ</div>
        </div>
    `).join('');
    document.getElementById('fabricModal').style.display = 'flex';
}

function selectFabric(name, price, img) {
    const id = Date.now();
    const div = document.createElement('div');
    div.className = 'selected-thobe-card';
    div.id = id;
    div.innerHTML = `
        <button class="remove-card" onclick="removeThobe(${id}, ${price})">Ã—</button>
        <b>Ù‚Ù…Ø§Ø´: ${name}</b> - ${price} Ø±ÙŠØ§Ù„
        <input type="hidden" class="item-price" value="${price}">
        <select class="thobe-opt"><option>ÙŠØ§Ù‚Ø© Ù‚Ù„Ø§Ø¨</option><option>ÙŠØ§Ù‚Ø© Ø³Ø§Ø¯Ø©</option></select>
        <select class="thobe-opt"><option>Ø£ÙƒÙ…Ø§Ù… ÙƒØ¨Ùƒ</option><option>Ø£ÙƒÙ…Ø§Ù… Ø³Ø§Ø¯Ø©</option></select>
    `;
    document.getElementById('tailor_list').appendChild(div);
    calcTotal();
    document.getElementById('fabricModal').style.display = 'none';
}

function removeThobe(id) { document.getElementById(id).remove(); calcTotal(); }

function renderReadyItems() {
    const d = document.getElementById('ready_display');
    d.innerHTML = db.ready.map(r => `
        <div class="product-card">
            <img src="${r.img}">
            <h4>${r.title}</h4>
            <div class="new-price">${r.newPrice} Ø±ÙŠØ§Ù„</div>
            <button onclick="addReady(${r.newPrice})" style="background:var(--brown); color:white; border:none; padding:5px 10px; margin-top:5px; border-radius:5px;">Ø¥Ø¶Ø§ÙØ©</button>
        </div>
    `).join('');
}

function addReady(p) { readyCartTotal += parseFloat(p); calcTotal(); }

function calcTotal() {
    let t = 0;
    document.querySelectorAll('.item-price').forEach(p => t += parseFloat(p.value));
    t += readyCartTotal;
    document.getElementById('final_total').innerText = t;
}

function encodeImg(i) {
    if (i.files && i.files[0]) {
        let r = new FileReader();
        r.onload = (e) => tempImg = e.target.result;
        r.readAsDataURL(i.files[0]);
    }
}

function saveToCloud() {
    const t = document.getElementById('adm_title').value;
    const p = document.getElementById('adm_new').value;
    const c = document.getElementById('adm_cat').value;
    if(!tempImg || !t || !p) return alert("Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
    database.ref('products').push({ cat: c, title: t, newPrice: p, img: tempImg })
    .then(() => { alert("ØªÙ… Ø§Ù„Ù†Ø´Ø±"); closeAdmin(); });
}

function submitOrder() {
    const n = document.getElementById('c_name').value;
    const p = document.getElementById('c_phone').value;
    if(!n || !p) return alert("Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ");
    alert("ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ ÙŠØ§ " + n + ".. Ø³Ù†Ø¨Ù‡Ø±Ùƒ Ø¨Ø¯Ù‚ØªÙ†Ø§!");
}

function toggleYaqoot() {
    const c = document.getElementById('yaqoot_chat');
    c.style.display = (c.style.display === 'block') ? 'none' : 'block';
}

function yaqootReply(t) {
    const txt = document.getElementById('chat_text');
    if(t==='policy') txt.innerHTML = "ğŸ›¡ï¸ Ø¶Ù…Ø§Ù†Ù†Ø§: Ø¯Ù‚Ø© ÙÙŠ Ø§Ù„Ù…Ù‚Ø§Ø³ Ø£Ùˆ Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨Ù„Øº ÙÙˆØ±Ø§Ù‹.";
    if(t==='offer') txt.innerHTML = "ğŸ Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ…: Ø¹Ù†Ø¯ ØªÙØµÙŠÙ„ Ø«ÙˆØ¨ÙŠÙ†ØŒ Ø§Ù„Ø«Ø§Ù„Ø« Ø¨Ù†ØµÙ Ø§Ù„Ø³Ø¹Ø±!";
}

function openAdmin() { document.getElementById('adminPanel').style.display = 'flex'; }
function closeAdmin() { document.getElementById('adminPanel').style.display = 'none'; }
</script>

</body>
</html>
